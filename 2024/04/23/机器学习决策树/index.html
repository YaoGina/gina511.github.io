
<!DOCTYPE html>
<html lang="en">
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  
    <link rel="icon" href="/gina511.github.io/img/favicon.png">
  
  
      <meta name="author" content="Gina">
  
  
  
  
  
    <link rel="alternate" href="/gina511.github.io/atom.xml " title="Gina&#39;s blog" type="application/atom+xml">
  

  

  <title>åŸºäºID3ç®—æ³•å’Œåå‰ªæçš„å†³ç­–æ ‘å®éªŒ | Gina&#39;s blog</title>

  

  

  

  <link rel="stylesheet" href="/gina511.github.io/css/style.css" >
  <link rel="stylesheet" href="/gina511.github.io/css/partial/dark.css" >

  
  
  

  
    
      <link rel="stylesheet" href="/gina511.github.io/css/partial/highlight/atom-one-light.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/css/iconfont.css">
    
  

  
    <script src="/gina511.github.io/js/todark.js"></script>
    
<meta name="generator" content="Hexo 7.1.1"></head>
</html>
    
<div class="nav index" style="height: 60px;">
    <div class="title animated fadeInDown">
        <div class="layui-container">
                <div class="nav-title"><a href="/gina511.github.io/" title="Gina&#39;s blog">Gina&#39;s blog</a></div>
            <div class="nav-list">
                <button> <span class=""></span><span style="display: block;"></span><span class=""></span> </button>
                <ul class="layui-nav" lay-filter="">
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/ ">
                            <i class=" fab fa-fort-awesome " style="color: rgb(255 107 107);"></i>
                            <span class="layui-nav-item-name">é¦–é¡µ</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/archives/ ">
                            <i class=" fas fa-archive " style="color: rgb(10 189 227);"></i>
                            <span class="layui-nav-item-name">åˆ—è¡¨</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/tags ">
                            <i class=" fas fa-hashtag " style="color: rgb(254 202 87);"></i>
                            <span class="layui-nav-item-name">æ ‡ç­¾</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/categories ">
                            <i class=" far fa-folder-open " style="color: rgb(29 209 161);"></i>
                            <span class="layui-nav-item-name">åˆ†ç±»</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/profile/æ¹–å—å¤§å­¦äººå·¥æ™ºèƒ½ä¸“ä¸šå§šå§¬å¨œ.pdf ">
                            <i class=" fab fa-grav " style="color: rgb(154 106 247);"></i>
                            <span class="layui-nav-item-name">å…³äº</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/link/ ">
                            <i class=" fab fa-weixin " style="color: hsl(152deg 73% 45%);"></i>
                            <span class="layui-nav-item-name">å‹é“¾</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/shuoshuo/ ">
                            <i class=" fas fa-coffee " style="color:#31c7c1;"></i>
                            <span class="layui-nav-item-name">è¯´è¯´</span>
                        </a>
                    </li>
                    
                    
                        <li class="layui-nav-item" id="btn-toggle-dark">ğŸŒ™</li>
                    
                    <span class="layui-nav-bar" style="left: 342px; top: 78px; width: 0px; opacity: 0;"></span>
                </ul>
            </div>
        </div>
    </div>
</div>
    
<header class="header">
        
            <div class="logo">
                    <a href="/gina511.github.io/"><img src="img/header.png" onerror=this.onerror=null,this.src="/gina511.github.io/img/loading.gif"></a>
            </div>
         
    </div>
     

            <div class="motto">
                <span>ä¸ºä½ ï¼Œåƒåƒä¸‡ä¸‡é</span>
            </div>
    
    
            <div class="social">
                
                        <a class="social-icon" href="https://yaogina.github.io/gina511.github.io/" target="_blank" title="Github">
                            <i class="iconfont icon-GitHub" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="gina2021@hnu.edu.cn" target="_blank" title="Email">
                            <i class="iconfont icon-email" aria-hidden="true"></i>
                          </a>
                 
            </div>
     
</header>

    
<article id="post">
  <div class="post-title">åŸºäºID3ç®—æ³•å’Œåå‰ªæçš„å†³ç­–æ ‘å®éªŒ</div>
  
<div class="post-meta">
    
    
      <div class="post-meta-item date">
        <span title="Created 2024.04.23"><i class="far fa-calendar-alt"></i> 2024.04.23</span>
      </div>
      <div class="post-meta-item updated">
        <span title="Updated 2024.04.17"><i class="far fa-calendar-check"></i> 2024.04.17</span>
      </div>
     
    
      <div class="post-meta-item categories">
        
          <i class="fas fa-inbox article-meta__icon"></i> <a href="/gina511.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a>
        
      </div>
     
    
     <div class="post-meta-item wordcount">
        
          <i class="fas fa-pencil-alt"></i> <span class="post-count">3.4k words</span>
           
        
          <i class="far fa-clock"></i> <span class="post-count">13 min</span>
                               
      </div>
     
</div>


  
  <div class="content">
        <div><h1 id="æœºå™¨å­¦ä¹ å†³ç­–æ ‘"><a href="#æœºå™¨å­¦ä¹ å†³ç­–æ ‘" class="headerlink" title="æœºå™¨å­¦ä¹ å†³ç­–æ ‘"></a>æœºå™¨å­¦ä¹ å†³ç­–æ ‘</h1><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>æœºå™¨å­¦ä¹ è¦æ±‚ä½¿ç”¨ä¸€ä¸ªå…­å±æ€§ï¼Œ1000æ¡æ•°æ®çš„caræ•°æ®é›†å»ºç«‹å†³ç­–æ ‘ï¼Œè¿™é‡Œè®°å½•æ‰‹æ“å†³ç­–æ ‘ä»£ç å®ç°ä»¥åŠä¸€äº›æ€§èƒ½åº¦é‡å’Œä¸ªäººæ„Ÿæ‚Ÿã€‚</p>
<span id="more"></span>

<h3 id="ä¸€ã€å®éªŒç»“è®º"><a href="#ä¸€ã€å®éªŒç»“è®º" class="headerlink" title="ä¸€ã€å®éªŒç»“è®º"></a>ä¸€ã€å®éªŒç»“è®º</h3><p><strong>å†³ç­–æ ‘ï¼ˆæœªå‰ªæï¼‰</strong></p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/decision_tree.png" alt="after_cut_dt"></p>
<p>è¿™é‡Œæ˜¯ä½¿ç”¨è‡ªå·±çš„å†³ç­–æ ‘å»ºç«‹æ–¹æ³•å»ºç«‹çš„å†³ç­–æ ‘ï¼Œåœ¨è®­ç»ƒé›†å æ¯”ä¸º0.8å¹¶ä¸”åˆ†å±‚åˆ’åˆ†å†³ç­–æ ‘ä¸­ç¬¬ä¸€è½®ç”Ÿæˆçš„å†³ç­–æ ‘çš„å¯è§†åŒ–å›¾åƒã€‚è¿™å¼ å›¾ç‰‡ä¸­çš„å†³ç­–æ ‘å¹¶æœªä½¿ç”¨å‰ªæç®—æ³•ï¼Œä½†æ˜¯ç”±äºä½¿ç”¨ä¿¡æ¯å¢ç›Šå»ºæ ‘ï¼Œè€Œåœ¨å»ºæ ‘è¿‡ç¨‹ä¸­å°±å†™äº†é€»è¾‘å¦‚æœä¿¡æ¯å¢ç›Šä¸º0å°±ç›´æ¥åˆ’åˆ†æˆå¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿç®—æ˜¯è¿›è¡Œäº†ä¸€ä¸ªå°å°çš„é¢„å‰ªæï¼Œæ‰€ä»¥æ ‘æå¹¶ä¸ä¼šå®Œå…¨åˆ’åˆ†å…­ä¸ªå±æ€§ã€‚</p>
<p><strong>å†³ç­–æ ‘ï¼ˆå‰ªæï¼Œä¿¡æ¯å¢ç›Šé˜ˆå€¼è®¾ç½®0.2ï¼‰</strong></p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/after_cut_dt.png" alt="after_cut_dt"></p>
<p>ä½¿ç”¨åå‰ªææ–¹æ³•å¯¹å·²ç»ç”Ÿæˆçš„å†³ç­–æ ‘è¿›è¡Œå‰ªæï¼Œå‰ªææŒ‰ç…§ä¿¡æ¯å¢ç›Šæ¥è®¾ç½®,å¦‚æœä¿¡æ¯å¢ç›Šä½äºæŸä¸ªè®¾å®šå¥½çš„é˜ˆå€¼ï¼Œå°±ä¼šå°†æ”¹å±æ€§æ”¹æˆå¶èŠ‚ç‚¹ï¼Œå¶èŠ‚ç‚¹çš„é€‰æ‹©æŒ‰ç…§åŸæœ¬å±æ€§åˆ’åˆ†ä¸­æœ€å¤šçš„æ ‡è®°æ•°èµ‹å€¼ï¼Œå¹¶ä¸”ä½¿ç”¨é€’å½’å‰ªæï¼Œèƒ½å¤Ÿå¤šå±‚å‰ªæï¼Œè¿™é‡Œå›¾åƒè¾“å‡ºæ—¶è®¾ç½®çš„å‰ªæé˜ˆå€¼ä¸º0.2ï¼Œæ‰€ä»¥å‡å»äº†è¾ƒå¤šåˆ†æ”¯ï¼Œç”Ÿæˆçš„å†³ç­–æ ‘ä¹Ÿæ¯”è¾ƒç®€å•ã€‚</p>
<p><strong>å†³ç­–æ ‘ï¼ˆsklearnåº“æ–¹æ³•ï¼‰</strong></p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/sklearntree.png" alt="after_cut_dt"></p>
<p>ä¸åŒæ•°æ®é›†åˆ†å±‚åˆ’åˆ†ï¼Œè·å¾—å››ä¸ªæ ‡è®°çš„<strong>æŸ¥å‡†ç‡ï¼ŒæŸ¥å…¨ç‡ï¼Œå‡†ç¡®ç‡ï¼ŒF1ä»¥åŠå¹³å‡å€¼æ›²çº¿</strong></p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/prf1sa.png" alt="prf1sa"></p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/image-20240411212718858.png" alt="image-20240411212718858"></p>
<p>è§‚å¯Ÿä¸Šå›¾ï¼Œ0.8åˆ’åˆ†çš„æ€§èƒ½ä¸­ï¼Œä½¿ç”¨sklearnè¾“å‡º<strong>præ›²çº¿</strong></p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/image-20240411195041609.png" alt="image-20240411212718858"></p>
<p>ä½¿ç”¨sklearnå¯¹æ€§èƒ½è¿›è¡Œè¯„æµ‹ã€‚<br>å›¾ä¸€æ˜¯ä½¿ç”¨sklearnéšæœºåˆ’åˆ†è®­ç»ƒé›†æµ‹è¯•é›†ï¼Œåå‰ªæåç”Ÿæˆçš„å†³ç­–æ ‘ã€‚<br>å›¾äºŒæ˜¯æ ¹æ®ä¸åŒçš„è®­ç»ƒé›†åˆ’åˆ†å æ¯”ï¼Œè®¡ç®—åˆ†å±‚æŠ½æ ·ç”Ÿæˆå†³ç­–æ ‘10æ¬¡å¹³å‡çš„æŸ¥å‡†ç‡ï¼ŒæŸ¥å…¨ç‡ï¼ŒF 1ï¼Œå‡†ç¡®åº¦ï¼Œä»¥åŠè¿™å‡ è€…å¹³å‡å€¼çš„æ›²çº¿<br>å›¾ä¸‰æ˜¯æ‰¾åˆ°æ€§èƒ½æœ€å¥½çš„è®­ç»ƒé›†åˆ’åˆ†æ¯”ä¾‹ï¼Œç»˜åˆ¶å‡ºçš„præ›²çº¿</p>
<h3 id="äºŒã€å…·ä½“å®ç°"><a href="#äºŒã€å…·ä½“å®ç°" class="headerlink" title="äºŒã€å…·ä½“å®ç°"></a>äºŒã€å…·ä½“å®ç°</h3><h4 id="1-ä¿¡æ¯å¢ç›Šå»ºæ ‘"><a href="#1-ä¿¡æ¯å¢ç›Šå»ºæ ‘" class="headerlink" title="1.ä¿¡æ¯å¢ç›Šå»ºæ ‘"></a>1.ä¿¡æ¯å¢ç›Šå»ºæ ‘</h4><p><strong>æ ‘èŠ‚ç‚¹å®šä¹‰</strong></p>
<p>è®°å½•æœ¬èŠ‚ç‚¹çš„åˆ†ç±»å±æ€§ï¼Œæœ¬èŠ‚ç‚¹çš„å…·ä½“å€¼ï¼Œæ ‡è®°å€¼ï¼Œä»¥åŠè¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, attribute=<span class="literal">None</span>, value=<span class="literal">None</span>, label=<span class="literal">None</span></span>):</span><br><span class="line">        self.attribute = attribute</span><br><span class="line">        self.value = value</span><br><span class="line">        self.label = label</span><br><span class="line">        self.children = &#123;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿¡æ¯ç†µè®¡ç®—</strong></p>
<p>ä»æ•°æ®é›†é‡Œè¯»å–æœ€åä¸€åˆ—çš„æ ‡è®°ï¼Œç„¶åè®¡æ•°æ€»å…±æœ‰å¤šå°‘æ ‡è®°ï¼Œä¹‹åé€šè¿‡<img src= "/gina511.github.io/img/loading.gif" data-src="/images/post-image/ml-report/image-20240409235857464.png" alt="image-20240409235857464" style="zoom: 67%;" />å…¬å¼è®¡ç®—è¿”å›ä¿¡æ¯ç†µã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">entropy</span>(<span class="params">data</span>):</span><br><span class="line">    labels = [row[-<span class="number">1</span>] <span class="keyword">for</span> row <span class="keyword">in</span> data]</span><br><span class="line">    label_counts = Counter(labels)</span><br><span class="line">    entropy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> label <span class="keyword">in</span> label_counts:</span><br><span class="line">        label_prob = label_counts[label] / <span class="built_in">len</span>(labels)</span><br><span class="line">        entropy += -label_prob * math.log2(label_prob)</span><br><span class="line">    <span class="keyword">return</span> entropy</span><br></pre></td></tr></table></figure>

<p><strong>ä¿¡æ¯å¢ç›Šè®¡ç®—</strong></p>
<p>æ ¹æ®ç»™å®šçš„å±æ€§è®¡ç®—æ•°æ®é›†çš„ä¿¡æ¯å¢ç›Šã€‚æ•°æ®é›†å’Œå±æ€§ä½œä¸ºå‚æ•°ã€‚æ ¹æ®å±æ€§çš„ç´¢å¼•æ‰¾åˆ°æ•°æ®é›†ä¸­å¯¹åº”çš„å±æ€§åˆ—ã€‚ç„¶åï¼Œæå–è¯¥å±æ€§åˆ—ä¸­çš„ä¸åŒå–å€¼,ç„¶åå¼€å§‹è®¡ç®—ä¿¡æ¯ç†µï¼Œè·å¾—ä¿¡æ¯ç†µä¹‹åï¼Œç”¨åŸæœ¬çš„ä¿¡æ¯ç†µå‡å»ä»¥è¿™ä¸ªå±æ€§åˆ’åˆ†ä¹‹åçš„ä¿¡æ¯ç†µã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">information_gain</span>(<span class="params">data, attribute</span>):</span><br><span class="line">    attribute_index = attribute_names.index(attribute)</span><br><span class="line">    attribute_values = <span class="built_in">set</span>([row[attribute_index] <span class="keyword">for</span> row <span class="keyword">in</span> data])</span><br><span class="line">    subset_entropy = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> attribute_values:</span><br><span class="line">        subset = [row <span class="keyword">for</span> row <span class="keyword">in</span> data <span class="keyword">if</span> row[attribute_index] == value]</span><br><span class="line">        subset_entropy += <span class="built_in">len</span>(subset) / <span class="built_in">len</span>(data) * entropy(subset)</span><br><span class="line">    <span class="keyword">return</span> entropy(data) - subset_entropy</span><br></pre></td></tr></table></figure>

<p><strong>å»ºæ ‘</strong></p>
<p>æ£€æŸ¥æ ‡ç­¾åˆ—è¡¨ä¸­æ˜¯å¦åªæœ‰ä¸€ä¸ª<strong>å”¯ä¸€çš„æ ‡ç­¾å€¼</strong>ã€‚å¦‚æœæ˜¯ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªå¶èŠ‚ç‚¹ï¼Œå°†è¯¥æ ‡ç­¾å€¼ä½œä¸ºèŠ‚ç‚¹çš„æ ‡ç­¾.</p>
<p>å¦‚æœ<strong>å±æ€§åˆ—è¡¨ä¸ºç©º</strong>ï¼Œåˆ™è®¡ç®—æ ‡ç­¾åˆ—è¡¨ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„æ ‡ç­¾ï¼Œå¹¶åˆ›å»ºå¶èŠ‚ç‚¹ï¼Œè¿”å›è¯¥èŠ‚ç‚¹ä½œä¸ºæ ‘çš„ä¸€ä¸ªåˆ†æ”¯ã€‚</p>
<p>é€‰æ‹©<strong>æœ€ä½³å±æ€§</strong>ï¼Œä½¿ç”¨ä¿¡æ¯å¢ç›Šå‡½æ•°è®¡ç®—å¾—åˆ°çš„ã€‚ä¿¡æ¯å¢ç›Šè¶Šå¤§ï¼Œæ„å‘³ç€é€‰æ‹©è¯¥å±æ€§å¯ä»¥ä½¿å¾—æ ·æœ¬çš„åˆ†ç±»æ›´åŠ çº¯å‡€.åˆ›å»ºèŠ‚ç‚¹ï¼Œå°†æœ€ä½³å±æ€§ä½œä¸ºèŠ‚ç‚¹çš„å±æ€§ï¼Œæ ¹æ®æœ€ä½³å±æ€§åœ¨æ•°æ®é›†ä¸­çš„ä½ç½®ï¼Œæå–è¯¥å±æ€§çš„æ‰€æœ‰å¯èƒ½å–å€¼ï¼Œå¹¶éå†æ¯ä¸ªå–å€¼.é’ˆå¯¹æ¯ä¸ªå–å€¼ï¼Œæ ¹æ®å±æ€§å€¼å°†æ•°æ®é›†åˆ†å‰²ä¸ºå­é›†ã€‚å¦‚æœå­é›†ä¸ºç©ºï¼Œè¯´æ˜è¯¥å–å€¼åœ¨å½“å‰å±æ€§ä¸‹æ²¡æœ‰æ ·æœ¬ï¼Œåˆ›å»ºä¸€ä¸ªå¶èŠ‚ç‚¹ï¼Œå¹¶å°†å‡ºç°é¢‘ç‡æœ€é«˜çš„æ ‡ç­¾ä½œä¸ºèŠ‚ç‚¹çš„æ ‡ç­¾ã€‚å¦‚æœå­é›†ä¸ä¸ºç©ºï¼Œè¯´æ˜è¯¥å–å€¼åœ¨å½“å‰å±æ€§ä¸‹æœ‰æ ·æœ¬ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„å±æ€§åˆ—è¡¨ï¼Œç§»é™¤æœ€ä½³å±æ€§ï¼Œå‰©ä¸‹çš„å±æ€§å­˜å‚¨åœ¨ remaining_attributes åˆ—è¡¨ä¸­ã€‚</p>
<p>ä¹‹åé€’å½’è°ƒç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">build_tree</span>(<span class="params">data, attributes</span>):</span><br><span class="line">    labels = [row[-<span class="number">1</span>] <span class="keyword">for</span> row <span class="keyword">in</span> data]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(labels)) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> Node(label=labels[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(attributes) == <span class="number">0</span>:</span><br><span class="line">        majority_label = Counter(labels).most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> Node(label=majority_label)</span><br><span class="line">    best_attribute = <span class="built_in">max</span>(attributes, key=<span class="keyword">lambda</span> attr: information_gain(data, attr))</span><br><span class="line">    node = Node(attribute=best_attribute)</span><br><span class="line">    attribute_index = attribute_names.index(best_attribute)</span><br><span class="line">    attribute_values = <span class="built_in">set</span>([row[attribute_index] <span class="keyword">for</span> row <span class="keyword">in</span> data])</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> attribute_values:</span><br><span class="line">        subset = [row <span class="keyword">for</span> row <span class="keyword">in</span> data <span class="keyword">if</span> row[attribute_index] == value]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(subset) == <span class="number">0</span>:</span><br><span class="line">            majority_label = Counter(labels).most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">            node.children[value] = Node(label=majority_label)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            remaining_attributes = [attr <span class="keyword">for</span> attr <span class="keyword">in</span> attributes <span class="keyword">if</span> attr != best_attribute]</span><br><span class="line">            node.children[value] = build_tree(subset, remaining_attributes)</span><br><span class="line">    <span class="keyword">return</span> node</span><br></pre></td></tr></table></figure>

<h4 id="2-åå‰ªæ"><a href="#2-åå‰ªæ" class="headerlink" title="2.åå‰ªæ"></a>2.åå‰ªæ</h4><p>ç”Ÿæˆå†³ç­–æ ‘åï¼Œè®¾ç½®ä¿¡æ¯å¢ç›Šé˜ˆå€¼å‰ªæã€‚</p>
<p>é¦–å…ˆæ£€æŸ¥å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰å­èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚åœ¨éå†å®Œæ‰€æœ‰å­èŠ‚ç‚¹åï¼Œè®¡ç®—å½“å‰èŠ‚ç‚¹çš„ä¿¡æ¯å¢ç›Šï¼Œåˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„æ ‡ç­¾æ˜¯å¦ä¸€è‡´ï¼Œæˆ–è€…å½“å‰èŠ‚ç‚¹çš„ä¿¡æ¯å¢ç›Šæ˜¯å¦å°äºè®¾å®šçš„é˜ˆå€¼ã€‚å¦‚æœå­èŠ‚ç‚¹çš„æ ‡ç­¾ä¸€è‡´æˆ–è€…ä¿¡æ¯å¢ç›Šå°äºé˜ˆå€¼ï¼Œåˆ™è¿›è¡Œå‰ªææ“ä½œã€‚å°†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹åˆå¹¶ä¸ºä¸€ä¸ªå¶èŠ‚ç‚¹ï¼Œè¯¥å¶èŠ‚ç‚¹çš„æ ‡ç­¾å€¼ä¸ºå½“å‰èŠ‚ç‚¹å­èŠ‚ç‚¹ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„æ ‡ç­¾å€¼ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Nodes before pruning: 45, Nodes after pruning: 27</span><br><span class="line">Nodes before pruning: 87, Nodes after pruning: 76</span><br><span class="line">Nodes before pruning: 130, Nodes after pruning: 86</span><br><span class="line">Nodes before pruning: 161, Nodes after pruning: 161</span><br><span class="line">Nodes before pruning: 171, Nodes after pruning: 110</span><br><span class="line">Nodes before pruning: 187, Nodes after pruning: 187</span><br><span class="line">Nodes before pruning: 191, Nodes after pruning: 191</span><br><span class="line">Nodes before pruning: 230, Nodes after pruning: 230</span><br><span class="line">Nodes before pruning: 239, Nodes after pruning: 239</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ¯ä¸ªè¾“å‡ºæ˜¯æŒ‰ç…§ä¸åŒçš„è®­ç»ƒé›†æ¯”ä¾‹åˆ’åˆ†ï¼Œæ¯”ä¾‹ä¸º<img src= "/gina511.github.io/img/loading.gif" data-src="C:\Users\æ¢§å½¹\AppData\Roaming\Typora\typora-user-images\image-20240411191301595.png" alt="image-20240411191301595" style="zoom:50%;" /><br>å¯ä»¥çœ‹åˆ°éšç€è®­ç»ƒé›†æ¯”ä¾‹ä¸æ–­å¢åŠ ï¼Œå»ºç«‹çš„æ ‘èŠ‚ç‚¹ä¹Ÿè¶Šå¤šï¼Œå‰ªæå‰ªå»çš„èŠ‚ç‚¹æ•°ç›®ä¹Ÿè¶Šå¤šã€‚è€Œè®­ç»ƒé›†æ¯”ä¾‹è¶Šå¤§ï¼ŒèŠ‚ç‚¹è¶Šå¤šï¼Œä¹Ÿè¶Šä¸å¥½å‰ªæï¼Œå› ä¸ºæ‹†å‡ºæ¥çš„è®­ç»ƒæ•°æ®çº¯åº¦ä¹Ÿä¼šè¶Šä½ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">postorder_prune</span>(<span class="params">node</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node.children:</span><br><span class="line">            <span class="keyword">return</span>        </span><br><span class="line">        <span class="keyword">for</span> child <span class="keyword">in</span> node.children.values():</span><br><span class="line">            postorder_prune(child)</span><br><span class="line">        node.gain = information_gain(validation_data, node.attribute)</span><br><span class="line">        <span class="keyword">if</span> is_label_consistent(node, validation_data) <span class="keyword">or</span> node.gain &lt;= gain_threshold:</span><br><span class="line">            merge_subtree(node)   </span><br><span class="line">    num_nodes_before_pruning = count_nodes(tree)</span><br><span class="line">    postorder_prune(tree)</span><br><span class="line">    num_nodes_after_pruning = count_nodes(tree)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Nodes before pruning: <span class="subst">&#123;num_nodes_before_pruning&#125;</span>, Nodes after pruning: <span class="subst">&#123;num_nodes_after_pruning&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>åˆå¹¶å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge_subtree</span>(<span class="params">node</span>):</span><br><span class="line">       node.label = Counter([row[-<span class="number">1</span>] <span class="keyword">for</span> row <span class="keyword">in</span> validation_data]).most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">       node.children = &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-å¯è§†åŒ–"><a href="#3-å¯è§†åŒ–" class="headerlink" title="3.å¯è§†åŒ–"></a>3.å¯è§†åŒ–</h4><p>æ£€æŸ¥å½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºå¶èŠ‚ç‚¹ã€‚</p>
<ul>
<li><p>æ˜¯ï¼Œå°†å½“å‰èŠ‚ç‚¹æ·»åŠ åˆ°å›¾ä¸­ï¼Œæ ‡ç­¾ä¸ºå–å€¼ã€‚</p>
</li>
<li><p>å¦ï¼Œå°†å½“å‰èŠ‚ç‚¹æ·»åŠ åˆ°å›¾ä¸­ï¼Œæ ‡ç­¾ä¸ºå±æ€§ã€‚</p>
</li>
<li><p>æ·»åŠ ä»å½“å‰èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹çš„æœ‰å‘è¾¹ï¼Œè¾¹çš„æ ‡ç­¾ä¸ºå­èŠ‚ç‚¹çš„å–å€¼ã€‚</p>
</li>
</ul>
<p>é€’å½’è°ƒç”¨â€visualize_treeâ€å‡½æ•°ï¼Œå°†å­èŠ‚ç‚¹ä½œä¸ºå‚æ•°ï¼Œä»¥ä¾¿ç»˜åˆ¶å­èŠ‚ç‚¹çš„å­æ ‘ã€‚æœ€åè¿”å›ç»˜åˆ¶å®Œæˆçš„å›¾ã€‚ </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">visualize_tree</span>(<span class="params">node, graph=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> graph <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        graph = graphviz.Digraph()   </span><br><span class="line">    <span class="keyword">if</span> node.label <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        graph.node(<span class="built_in">str</span>(<span class="built_in">id</span>(node)), label=node.label, shape=<span class="string">&#x27;box&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        graph.node(<span class="built_in">str</span>(<span class="built_in">id</span>(node)), label=node.attribute)    </span><br><span class="line">    <span class="keyword">for</span> value, child <span class="keyword">in</span> node.children.items():</span><br><span class="line">        <span class="keyword">if</span> child.label <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            graph.node(<span class="built_in">str</span>(<span class="built_in">id</span>(child)), label=child.label, shape=<span class="string">&#x27;box&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            graph.node(<span class="built_in">str</span>(<span class="built_in">id</span>(child)), label=child.attribute)</span><br><span class="line">        graph.edge(<span class="built_in">str</span>(<span class="built_in">id</span>(node)), <span class="built_in">str</span>(<span class="built_in">id</span>(child)), label=value)</span><br><span class="line">        visualize_tree(child, graph)   </span><br><span class="line">    <span class="keyword">return</span> graph</span><br></pre></td></tr></table></figure>

<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/after_cut_dt.png" alt="after_cut_dt"></p>
<h4 id="4-è¯„ä¼°å†³ç­–æ ‘"><a href="#4-è¯„ä¼°å†³ç­–æ ‘" class="headerlink" title="4.è¯„ä¼°å†³ç­–æ ‘"></a>4.è¯„ä¼°å†³ç­–æ ‘</h4><h5 id="1-åˆ†å±‚æŠ½æ ·"><a href="#1-åˆ†å±‚æŠ½æ ·" class="headerlink" title="1.åˆ†å±‚æŠ½æ ·"></a>1.åˆ†å±‚æŠ½æ ·</h5><p>ä½¿ç”¨sklearnåº“å‡½æ•° StratifiedShuffleSplitï¼Œå¯¹æ•°æ®é›†çš„åˆ’åˆ†è¿›è¡Œåˆ†å±‚æŠ½æ ·å’Œäº¤å‰éªŒè¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sss = StratifiedShuffleSplit(n_splits=num_train, test_size=<span class="number">0.2</span>, random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<img src= "/gina511.github.io/img/loading.gif" data-src="/images/post-image/ml-report/image-20240411164801620.png" alt="image-20240411164801620" style="zoom:80%;" />

<h5 id="2-äº¤å‰éªŒè¯"><a href="#2-äº¤å‰éªŒè¯" class="headerlink" title="2.äº¤å‰éªŒè¯"></a>2.äº¤å‰éªŒè¯</h5><p>ä½¿ç”¨sklearnåº“ä¸­StratifiedShuffleSplitçš„splitæ–¹æ³•ï¼Œäº¤å‰éªŒè¯çš„è¿­ä»£ï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œå°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç´¢å¼•ã€‚</p>
<p>ä¹‹åå°±æ­£å¸¸çš„æŒ‰ç…§ç´¢å¼•åˆ’åˆ†æ•°æ®é›†ï¼Œå»ºç«‹å†³ç­–æ ‘ï¼Œç„¶åè®¡ç®—æ€§èƒ½æŒ‡æ ‡ï¼Œæœ€åç®—å‡ºå¹³å‡å€¼ã€‚ç”±äºä¸Šé¢è°ƒç”¨å‡½æ•°çš„æ—¶å€™num_trainæ˜¯10ï¼Œæ‰€ä»¥ä¼šè¿›è¡Œåæ¬¡æ´—ç‰Œåˆ’åˆ†æ•°æ®é›†ï¼Œç›¸å½“äºè®¡ç®—åæ¬¡å»ºæ ‘æœ€åå¾—åˆ°çš„æ€§èƒ½æŒ‡æ ‡çš„å¹³å‡å€¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> train_index, test_index <span class="keyword">in</span> sss.split(X, y):</span><br><span class="line">    train_data = data[train_index]</span><br><span class="line">    test_data = data[test_index]</span><br><span class="line">    tree = build_tree(train_data, attribute_names)</span><br><span class="line">    post_pruning(tree, validation_data=test_data, gain_threshold=<span class="number">0.01</span>)</span><br><span class="line">    y_true, y_pred = get_classification_results(tree, test_data)</span><br><span class="line">    precision = precision_score(y_true, y_pred, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line">    recall = recall_score(y_true, y_pred, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line">    f1_score = f1_score(y_true, y_pred, average=<span class="string">&#x27;macro&#x27;</span>)</span><br><span class="line">    accuracy = accuracy_score(y_true, y_pred)</span><br><span class="line">    precision_list.append(precision)</span><br><span class="line">    recall_list.append(recall)</span><br><span class="line">    f1_score_list.append(f1_score)</span><br><span class="line">    accuracy_list.append(accuracy)</span><br><span class="line">avg_precision = np.mean(precision_list)</span><br><span class="line">avg_recall = np.mean(recall_list)</span><br><span class="line">avg_f1_score = np.mean(f1_score_list)</span><br><span class="line">avg_accuracy = np.mean(accuracy_list)</span><br></pre></td></tr></table></figure>



<h5 id="3-æ€§èƒ½æŒ‡æ ‡è®¡ç®—å…¬å¼"><a href="#3-æ€§èƒ½æŒ‡æ ‡è®¡ç®—å…¬å¼" class="headerlink" title="3.æ€§èƒ½æŒ‡æ ‡è®¡ç®—å…¬å¼"></a>3.æ€§èƒ½æŒ‡æ ‡è®¡ç®—å…¬å¼</h5><p>æ­£å¸¸éå†æµ‹è¯•é›†ï¼Œè·å¾—å†³ç­–æ ‘å¯¹æµ‹è¯•é›†çš„é¢„æµ‹ç»“æœï¼Œæ ¹æ®ç»“æœè®¡ç®—é¢„æµ‹æ­£ç¡®é”™è¯¯çš„ç›¸å…³æ ‡è®°ä¸ªæ•°ã€‚æ ¹æ®è¿™äº›ä¸ªæ•°è®¡ç®—æŸ¥å‡†ç‡ï¼ŒæŸ¥å…¨ç‡ï¼Œf1,å’Œæ­£ç¡®æ€§ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, instance <span class="keyword">in</span> <span class="built_in">enumerate</span>(test_data):</span><br><span class="line">       predicted_label = classify_instance(instance, tree)</span><br><span class="line">       actual_label = instance[-<span class="number">1</span>]</span><br><span class="line">       <span class="keyword">if</span> predicted_label == actual_label:</span><br><span class="line">           true_positives += <span class="number">1</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           <span class="keyword">if</span> predicted_label <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">               false_positives += <span class="number">1</span></span><br><span class="line">           <span class="keyword">else</span>:</span><br><span class="line">               false_negatives += <span class="number">1</span></span><br><span class="line">   </span><br><span class="line">   precision = true_positives / (true_positives + false_positives)</span><br><span class="line">   recall = true_positives / (true_positives + false_negatives)</span><br><span class="line">   f1_score = <span class="number">2</span> * (precision * recall) / (precision + recall)</span><br><span class="line">   accuracy = true_positives / test_size</span><br></pre></td></tr></table></figure>



<h5 id="4-æ€§èƒ½å›¾åƒ"><a href="#4-æ€§èƒ½å›¾åƒ" class="headerlink" title="4.æ€§èƒ½å›¾åƒ"></a>4.æ€§èƒ½å›¾åƒ</h5><p>ä¸ºäº†è§‚æµ‹ä¸åŒè®­ç»ƒé›†ä¸æµ‹è¯•é›†åˆ’åˆ†æ¯”ä¾‹å¯¹ç»“æ„çš„å½±å“ï¼Œè®¾ç½®ä¸åŒåˆ’åˆ†æ¯”ä¾‹ï¼Œä¹‹åè¾“å‡ºæ€§èƒ½å›¾åƒï¼Œè·å¾—å¦‚ä¸‹å›¾åƒã€‚è¯¥å›¾åƒä¸ºåæ¬¡æ´—ç‰ŒæŒ‰ç…§è®­ç»ƒé›†0.8ï¼Œåˆ†å±‚åˆ’åˆ†æ•°æ®é›†ï¼Œå¾—åˆ°çš„æŸ¥å‡†ç‡ï¼ŒæŸ¥å…¨ï¼Œå‡†ç¡®ï¼Œf1å’Œå››è€…å¹³å‡å€¼çš„çš„æ›²çº¿å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">train_ratios = [<span class="number">0.1</span>,<span class="number">0.2</span>,<span class="number">0.3</span>,<span class="number">0.4</span>,<span class="number">0.5</span>,<span class="number">0.6</span>, <span class="number">0.7</span>, <span class="number">0.8</span>, <span class="number">0.9</span>]</span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">for</span> train_ratio <span class="keyword">in</span> train_ratios:</span><br><span class="line">    precision, recall, f1_score, accuracy = evaluate_decision_tree(data, attribute_names, train_ratio)</span><br><span class="line">    results.append((train_ratio, precision, recall, f1_score, accuracy))</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®å›¾åƒå¯ä»¥å¾—çŸ¥ï¼Œå½“è®­ç»ƒé›†å 0.8æ—¶ï¼Œå¾—åˆ°çš„å†³ç­–æ ‘æ€§èƒ½å¹³å‡è¡¨ç°è¾ƒå¥½ï¼Œæ‰€ä»¥åç»­é€‰æ‹©æµ‹è¯•åœ¨è®­ç»ƒé›†å æ¯”0.8æ—¶ï¼Œå°è¯•ç”»å‡ºpræ›²çº¿å›¾ã€‚</p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/prf1sa.png" alt="prf1sa"></p>
<h5 id="5-præ›²çº¿å›¾"><a href="#5-præ›²çº¿å›¾" class="headerlink" title="5.præ›²çº¿å›¾"></a>5.præ›²çº¿å›¾</h5><img src= "/gina511.github.io/img/loading.gif" data-src="C:\Users\æ¢§å½¹\AppData\Roaming\Typora\typora-user-images\image-20240411195047737.png" alt="image-20240411195047737" style="zoom: 80%;" />

<p>ç”±äºå†³ç­–æ ‘æ˜¯ä¸€ä¸ªå¤šåˆ†ç±»é—®é¢˜ï¼Œäºæ˜¯è¿˜éœ€è¦å¯¹æµ‹è¯•é›†è¿›è¡Œå¤šåˆ†ç±»æ ‡ç­¾äºŒè¿›åˆ¶åŒ–ï¼Œç„¶åè°ƒç”¨precision_recall_curveè¿™ä¸ªå‡½æ•°ï¼Œå¯¹æµ‹è¯•é›†æ­£ç¡®ç»“æœå’Œé¢„æµ‹ç»“æœè¿›è¡ŒåŒ¹é…ï¼Œè®¡ç®—å‡ºæŸ¥å‡†ç‡ï¼ŒæŸ¥å…¨ç‡ç­‰ç­‰ï¼Œç„¶åç»˜åˆ¶å›¾åƒã€‚å¾—åˆ°çš„å›¾åƒå¦‚ä¸Šå›¾ï¼Œç„¶åå†è®¡ç®—å‡ºæŠ˜çº¿é¢ç§¯ï¼Œè¾“å‡ºä¸åŒå±æ€§çš„præ›²çº¿é¢ç§¯ï¼Œæ ¹æ®é¢ç§¯è¯„åˆ¤å†³ç­–æ ‘æ€§èƒ½ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">y_pred = tree_classifier.predict(X_test)</span><br><span class="line">y_test_bin = label_binarize(y_test, classes=tree_classifier.classes_)</span><br><span class="line">precision = <span class="built_in">dict</span>()</span><br><span class="line">recall = <span class="built_in">dict</span>()</span><br><span class="line">n_classes = <span class="built_in">len</span>(tree_classifier.classes_)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_classes):</span><br><span class="line">    precision[i], recall[i], _ = precision_recall_curve(y_test_bin[:, i], tree_classifier.predict_proba(X_test)[:, i])</span><br></pre></td></tr></table></figure>

<p>label_binarize å°†å¤šåˆ†ç±»æ ‡ç­¾è½¬æ¢ä¸ºäºŒè¿›åˆ¶å½¢å¼ã€‚<br>ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸‰ä¸ªç±»åˆ« [A, B, C]ï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸ªæ ·æœ¬çš„æ ‡ç­¾ [A, B, C, A]ï¼Œç»è¿‡ label_binarize å¤„ç†åï¼Œä¼šè½¬æ¢ä¸ºäºŒè¿›åˆ¶å½¢å¼çš„æ•°ç»„ [[1, 0, 0], [0, 1, 0], [0, 0, 1], [1, 0, 0]]ï¼Œå…¶ä¸­æ¯ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªæ ·æœ¬çš„æ ‡ç­¾æ˜¯å¦å±äºå¯¹åº”ç±»åˆ«ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_classes):</span><br><span class="line">    plt.plot(recall[i], precision[i], marker=<span class="string">&#x27;o&#x27;</span>, label=tag[i])</span><br><span class="line">    area_i = precision[i].mean() * recall[i].mean()</span><br><span class="line">    areas.append(area_i) </span><br><span class="line">    plt.text(<span class="number">0.5</span>, <span class="number">0.05</span>*(i+<span class="number">1</span>), <span class="string">f&#x27;Area(<span class="subst">&#123;tag[i]&#125;</span>): <span class="subst">&#123;area_i:<span class="number">.2</span>f&#125;</span>&#x27;</span>, fontsize=<span class="number">10</span>) </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„prå›¾ï¼Œèƒ½å¤Ÿå¤§æ¦‚ååº”prå›¾åƒè¶‹åŠ¿ï¼Œæ•´ä½“æ¥çœ‹ï¼Œè¡¨ç°æœ€å¥½çš„æ˜¯naccå’Œacc ,å…¶æ¬¡æ‰æ˜¯goodå’Œvgoodï¼Œå¤§æ¦‚åˆ†å¸ƒæ˜¯ç¬¦åˆæ•°æ®é›†ä¸­çš„æ•°æ®åˆ†å¸ƒçš„ã€‚</p>
<img src= "/gina511.github.io/img/loading.gif" data-src="C:\Users\æ¢§å½¹\AppData\Roaming\Typora\typora-user-images\image-20240411195133267.png" alt="image-20240411195133267" style="zoom:33%;" />

<h3 id="ä¸‰ã€å°ç»„æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”"><a href="#ä¸‰ã€å°ç»„æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”" class="headerlink" title="ä¸‰ã€å°ç»„æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”"></a>ä¸‰ã€å°ç»„æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”</h3><p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/image-20240417173201331.png" alt="image-20240417173201331"></p>
<p>è¿™é‡Œè·å¾—å››ç§ç­–ç•¥æœ€ä½³æ€§èƒ½è¡¨ç°å¯¹åº”çš„è®­ç»ƒé›†&amp;éªŒè¯é›†åˆ’åˆ†æ¯”ä¾‹</p>
<p>ä¹Ÿå¯ä»¥çœ‹åˆ°éšç€è®­ç»ƒé›†å æ¯”ä¸æ–­å¢åŠ ï¼Œå†³ç­–æ ‘æ•´ä½“æ€§èƒ½æ˜¯è¶Šæ¥è¶Šå¥½çš„ï¼Œä½†æ€§èƒ½å˜åŒ–æ¢¯åº¦åœ¨ä¸æ–­å‡å°ï¼Œåœ¨0.8ä¸0.9ä¹‹é—´ï¼Œæ€§èƒ½å¯èƒ½ä¼šç•¥æœ‰ä¸‹é™ã€‚æˆ‘ä»¬è®¤ä¸ºè®­ç»ƒé›†è¶Šå¤šï¼Œè®­ç»ƒçš„æ•°æ®è¶Šå®Œå–„ï¼Œå¹¶ä¸”å‰ªæçš„æ¦‚ç‡ä¹Ÿä¼šç›¸åº”å‡å°ï¼Œäºæ˜¯å†³ç­–æ ‘æ‹¥æœ‰æ›´å¤šèŠ‚ç‚¹å‡†ç¡®é¢„æµ‹ï¼Œä½†æ˜¯å½“è®­ç»ƒé›†è¿‡å¤šï¼Œæœ‰äº›æ•°æ®å¯¹èŠ‚ç‚¹çš„åŠ å…¥å¸®åŠ©å¹¶ä¸å¤§ï¼Œæ‰€ä»¥æ¢¯åº¦ä¼šé™ä½ï¼Œå¹¶ä¸”è®­ç»ƒæ•°æ®è¿‡å¤šå¯èƒ½ä¼šå‡ºç°è¿‡æ‹Ÿåˆçš„ç°è±¡ã€‚</p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/ml-report/image-20240417173251175.png" alt="image-20240417173251175"></p>
<ul>
<li>unacc åŸºå°¼å&gt;ID3é¢„&gt;åŸºå°¼é¢„&gt;ID3å</li>
<li>acc    ID3å&gt;åŸºå°¼å&gt;ä¿¡æ¯é¢„&gt;åŸºå°¼é¢„</li>
<li>good  åŸºå°¼å&gt;Id3é¢„&gt;Id3å&gt;åŸºå°¼é¢„</li>
<li>vgood ID3é¢„&gt;ID3å&gt;åŸºå°¼å&gt;åŸºå°¼é¢„</li>
</ul>
<p>åœ¨å°½é‡æ§åˆ¶å…¶ä»–å˜é‡ç›¸åŒï¼Œå‘æŒ¥åŸºå°¼æŒ‡æ•°ã€ä¿¡æ¯å¢ç›Šã€é¢„å‰ªæã€åå‰ªæç®—æ³•æ’åˆ—ç»„åˆæœ€å¥½æ€§èƒ½çš„æ—¶å€™ï¼Œè¾“å‡ºä»–ä»¬å„è‡ªpræ›²çº¿ï¼ŒæŒ‰ç…§æ›²çº¿çš„é¢ç§¯å¤§å°å¯¹è·å¾—çš„ç»“æœè¿›è¡Œæ’åºåˆ†æã€‚æˆ‘ä»¬å°ç»„è®¤ä¸º<br>åå‰ªæçš„è¡¨ç°æ¯”é¢„å‰ªæç¨å¥½ï¼Œç”±äºå…¶åœ¨ç”Ÿæˆå®Œæ•´çš„å†³ç­–æ ‘ä¹‹åå†å‰ªæï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨æ•°æ®é›†ã€‚<br>è€ŒID3çš„è¡¨ç°ä¹Ÿæ¯”åŸºå°¼æŒ‡æ•°åˆ’åˆ†å±æ€§è¡¨ç°ç¨å¥½ï¼ŒäºŒè€…éƒ½å±äºè´ªå¿ƒç­–ç•¥å»ºæ ‘ï¼Œä½†æ˜¯ä¿¡æ¯å¢ç›Šä½¿ç”¨logå‡½æ•°ï¼Œå…¶æ¢¯åº¦å˜åŒ–æ›´åŠ ç¬¦åˆå®é™…è¿‡ç¨‹ä¸­çš„æ•°æ®è¶‹åŠ¿ã€‚ä½†ID3çš„è®¡ç®—å¯¹æ¯”åŸºå°¼æŒ‡æ•°ä¹Ÿæ›´ä¸ºå¤æ‚ï¼Œå®é™…åº”ç”¨ä¸­å› åšå‡ºå–èˆã€‚</p>
<h3 id="å››ã€å®éªŒæ”¶è·"><a href="#å››ã€å®éªŒæ”¶è·" class="headerlink" title="å››ã€å®éªŒæ”¶è·"></a>å››ã€å®éªŒæ”¶è·</h3><p>æ•´ä½“å®éªŒå®Œæˆä¹‹åï¼Œå¯¹å†³ç­–æ ‘çš„ç†è§£æ›´åŠ æ·±å…¥ï¼Œå°¤å…¶æ˜¯é€’å½’ç®—æ³•ï¼Œé€šè¿‡é€’å½’ç®—æ³•å»ºæ ‘ï¼Œåå‰ªæä»€ä¹ˆçš„ã€‚å¹¶ä¸”å¯¹æŸ¥å‡†ç‡ï¼ŒæŸ¥å…¨ç‡ï¼Œf1å’Œå‡†ç¡®ç‡çš„è®¡ç®—æ›´åŠ ç†Ÿæ‚‰ï¼Œä¹‹å‰çœ‹æœºå™¨å­¦ä¹ è®ºæ–‡ï¼Œåœ¨ä»‹ç»å®Œå®ç°ä¹‹åéƒ½ä¼šæœ‰ä¸€ä¸ªç« èŠ‚ä»‹ç»æµ‹è¯•ç»“æœï¼Œå½“æ—¶å¯¹è¿™ç§è¯„ä»·æŒ‡æ ‡æ²¡æœ‰å¾ˆå¤šçš„ç†è§£ï¼Œä½†æ˜¯è¿™æ¬¡å®éªŒåšå®Œå¯¹äºæœºå™¨å­¦ä¹ ç®—æ³•è¯„ä»·å‡½æ•°çš„å¿…è¦æ€§æœ‰å¾ˆå¤§çš„è®¤è¯†ã€‚</p>
</div>
        
  </div>

  <div class="share-reward">
    <div class="share">
        
<div class="social-share" data-sites="facebook,twitter,wechat,weibo,qq"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css">
<script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script>


      </div>
        <div class="reward">
          
        </div>
    </div>
    
    <div class="post_tags">
      
        <i class="fas fa-tag"></i> <a href="/gina511.github.io/tags/%E5%86%B3%E7%AD%96%E6%A0%91/" class="tag">å†³ç­–æ ‘</a>
      
        <i class="fas fa-tag"></i> <a href="/gina511.github.io/tags/%E5%90%8E%E5%89%AA%E6%9E%9D/" class="tag">åå‰ªæ</a>
      
        <i class="fas fa-tag"></i> <a href="/gina511.github.io/tags/ID3/" class="tag">ID3</a>
      
        <i class="fas fa-tag"></i> <a href="/gina511.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class="tag">æœºå™¨å­¦ä¹ </a>
      
    </div>
    <div class="post-nav">
      
        <div class="post-nav-prev post-nav-item">
            <a href="/gina511.github.io/2024/04/23/%E8%BE%B9%E7%95%8C%E5%A4%84%E7%90%86%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A/" >è®¡ç®—æœºè§†è§‰è¾¹ç•Œå¤„ç†è®ºæ–‡é˜…è¯»è®°å½•ï¼ˆCOB+HED)<i class="fa fa-chevron-left"></i></a>
        </div>
      
      
        <div class="post-nav-next post-nav-item">
            <a href="/gina511.github.io/2024/04/12/gpt%E8%B0%83%E7%94%A8/" >NLPæ¥å£è°ƒç”¨è®°å½•<i class="fa fa-chevron-right"></i></a>
        </div>
      
    </div>
      



  <div id="valine"></div>
  <script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script>
  <script>
        new Valine({
          el: '#valine',
          appId: "",
          appKey: "",
          avatar: "mm",
          lang: "",
          meta: 'nick,mail,link'.split(','),
          requiredFields: 'nick,mail'.split(','),
          placeholder: "è¯„è®ºè®°å¾—å¸¦ä¸Šé‚®ç®±,ä½ çš„ç•™è¨€æˆ‘ä¼šé©¬ä¸Šæ”¶åˆ°é‚®ç®±æé†’å“’",
          pageSize:'10',
          recordIP: 'false',
          serverURLs: "",
          emojiCDN: "",
          enableQQ: "true",
        });
  </script>
  

</article>

    
<a id="gotop" href="javascript:" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
    






    
<div id="bottom-outer">
    <div id="bottom-inner">
        Â© 2020 <i class="fa fa-heart" id="heart"></i> Gina 
        <br>
        Powered by 
        <a target="_blank" rel="noopener" href="http://hexo.io">hexo</a> | Theme is <a target="_blank" rel="noopener" href="https://github.com/a2396837/hexo-theme-blank/">blank</a>
        
          <div class="icp-info">
            
          <a href="" target="_blank"> </a>
        </div>
        
    </div>  
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/layui-src@2.5.5/dist/layui.min.js"></script>



  
    <script src="/gina511.github.io/js/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
  

 



  <script>
    window.lazyLoadOptions = {
      elements_selector: 'img',
      threshold: 0
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script>   
  


  <script>
    var images = $('img').not('.nav-logo img').not('.card img').not($('a>img')).not('.reward-content img')
    images.each(function (i, o) {
      var lazyloadSrc = $(o).attr('data-src') ? $(o).attr('data-src') : $(o).attr('src')
      $(o).wrap(`<a href="${lazyloadSrc}" data-fancybox="group" data-caption="${$(o).attr('alt')}" class="fancybox"></a>`)
    })
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script>
  <script>
        $().fancybox({
      selector: '[data-fancybox]',
      loop: true,
      transitionEffect: 'slide',
      protect: true,
      buttons: ['slideShow', 'fullScreen', 'thumbs', 'close']
    })
  </script>   
  








  
<div id="QPlayer">
	<div id="pContent">
		<div id="player">
			<span class="cover"></span>
			<div class="ctrl">
				<div class="musicTag marquee">
					<strong>Title</strong>
					 <span> - </span>
					<span class="artist">Artist</span>
				</div>
				<div class="progress">
					<div class="timer left">0:00</div>
					<div class="contr">
						<div class="rewind icon"></div>
						<div class="playback icon"></div>
						<div class="fastforward icon"></div>
					</div>
					<div class="right">
						<div class="liebiao icon"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="ssBtn">
				<div class="adf"><i class="fas fa-music" style="color: #Fff;"></i></div>
		</div>
	</div>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/css/audio.css">
	<ol id="playlist"></ol>
</div>
<script src="https://cdn.jsdelivr.net/npm/jquery.marquee@1.5.0/jquery.marquee.min.js"></script>
<script>
	var playlist = [];
	
		  playlist.push({title:'I will get over u',artist:'Loving Caliber / Mia Niles',mp3:'http://music.163.com/song/media/outer/url?id=2022403346.mp3',cover:'https://p3.music.126.net/UWSKMO96-nqAn-l1BGX9SQ==/893902953435039.jpg'})
	  
	var isRotate = true;
	var autoplay = false;
  </script>
<script src="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/js/player.js"></script>
<script>
  function bgChange(){
	var lis= $('.lib');
	for(var i=0; i<lis.length; i+=2)
	lis[i].style.background = 'rgba(246, 246, 246, 0.5)';
  }
  window.onload = bgChange;
</script>

  


  <script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script>
  


  <script src="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/js/firework.js"></script>
  


  
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"></script>
<script>
!function (e, t, a) {
  var initCopyCode = function(){
    var copyHtml = '';
    copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
    copyHtml += '  <i class="fa fa-clipboard"></i><span>å¤åˆ¶</span>';
    copyHtml += '</button>';
    $(".highlight .code pre").before(copyHtml);
    new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
  }
  initCopyCode();
}(window, document);
</script>  
  

<script>
  var btntop = $('#gotop');
  btntop.on('click', function (e) {
    e.preventDefault();
    $('html, body').animate({ scrollTop: 0 }, '300');
  });

  var $table = $('.content table').not($('figure.highlight > table'))
$table.each(function () {
  $(this).wrap('<div class="table-wrap"></div>')
})
</script>



</html>