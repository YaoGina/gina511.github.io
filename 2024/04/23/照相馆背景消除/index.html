
<!DOCTYPE html>
<html lang="en">
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  
    <link rel="icon" href="/gina511.github.io/img/favicon.png">
  
  
      <meta name="author" content="Gina">
  
  
  
  
  
    <link rel="alternate" href="/gina511.github.io/atom.xml " title="Gina" type="application/atom+xml">
  

  

  <title>Carvana ImageMasking Challenge  [åŸºäºUNETçš„kaggleå›¾åƒé®è”½æŒ‘æˆ˜] | Gina</title>

  

  

  

  <link rel="stylesheet" href="/gina511.github.io/css/style.css" >
  <link rel="stylesheet" href="/gina511.github.io/css/partial/dark.css" >

  
  
  

  
    
      <link rel="stylesheet" href="/gina511.github.io/css/partial/highlight/atom-one-light.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/css/iconfont.css">
    
  

  
    <script src="/gina511.github.io/js/todark.js"></script>
    
<meta name="generator" content="Hexo 7.1.1"></head>
</html>
    
<div class="nav index" style="height: 60px;">
    <div class="title animated fadeInDown">
        <div class="layui-container">
                <div class="nav-title"><a href="/gina511.github.io/" title="Gina">Gina</a></div>
            <div class="nav-list">
                <button> <span class=""></span><span style="display: block;"></span><span class=""></span> </button>
                <ul class="layui-nav" lay-filter="">
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/ ">
                            <i class=" fab fa-fort-awesome " style="color: rgb(255 107 107);"></i>
                            <span class="layui-nav-item-name">é¦–é¡µ</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/archives/ ">
                            <i class=" fas fa-archive " style="color: rgb(10 189 227);"></i>
                            <span class="layui-nav-item-name">åˆ—è¡¨</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/tags ">
                            <i class=" fas fa-hashtag " style="color: rgb(254 202 87);"></i>
                            <span class="layui-nav-item-name">æ ‡ç­¾</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/categories ">
                            <i class=" far fa-folder-open " style="color: rgb(29 209 161);"></i>
                            <span class="layui-nav-item-name">åˆ†ç±»</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/profile/æ¹–å—å¤§å­¦äººå·¥æ™ºèƒ½ä¸“ä¸šå§šå§¬å¨œ.pdf ">
                            <i class=" fab fa-grav " style="color: rgb(154 106 247);"></i>
                            <span class="layui-nav-item-name">å…³äº</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/link/ ">
                            <i class=" fab fa-weixin " style="color: hsl(152deg 73% 45%);"></i>
                            <span class="layui-nav-item-name">å‹é“¾</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/gina511.github.io/shuoshuo/ ">
                            <i class=" fas fa-coffee " style="color:#31c7c1;"></i>
                            <span class="layui-nav-item-name">è¯´è¯´</span>
                        </a>
                    </li>
                    
                    
                        <li class="layui-nav-item" id="btn-toggle-dark">ğŸŒ™</li>
                    
                    <span class="layui-nav-bar" style="left: 342px; top: 78px; width: 0px; opacity: 0;"></span>
                </ul>
            </div>
        </div>
    </div>
</div>
    
<header class="header">
        
            <div class="logo">
                    <a href="/gina511.github.io/"><img src="img/header.png" onerror=this.onerror=null,this.src="/gina511.github.io/img/loading.gif"></a>
            </div>
         
    </div>
     

            <div class="motto">
                <span>ä¸ºä½ ï¼Œåƒåƒä¸‡ä¸‡é</span>
            </div>
    
    
            <div class="social">
                
                        <a class="social-icon" href="https://yaogina.github.io/gina511.github.io/" target="_blank" title="Github">
                            <i class="iconfont icon-GitHub" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="gina2021@hnu.edu.cn" target="_blank" title="Email">
                            <i class="iconfont icon-email" aria-hidden="true"></i>
                          </a>
                 
            </div>
     
</header>

    
<article id="post">
  <div class="post-title">Carvana ImageMasking Challenge  [åŸºäºUNETçš„kaggleå›¾åƒé®è”½æŒ‘æˆ˜]</div>
  
<div class="post-meta">
    
    
      <div class="post-meta-item date">
        <span title="Created 2024.04.23"><i class="far fa-calendar-alt"></i> 2024.04.23</span>
      </div>
      <div class="post-meta-item updated">
        <span title="Updated 2024.05.26"><i class="far fa-calendar-check"></i> 2024.05.26</span>
      </div>
     
    
      <div class="post-meta-item categories">
        
          <i class="fas fa-inbox article-meta__icon"></i> <a href="/gina511.github.io/categories/cv/">cv</a>
        
      </div>
     
    
     <div class="post-meta-item wordcount">
        
          <i class="fas fa-pencil-alt"></i> <span class="post-count">4.3k words</span>
           
        
          <i class="far fa-clock"></i> <span class="post-count">17 min</span>
                               
      </div>
     
</div>


  
  <div class="content">
        <div><h1 id="Carvana-ImageMasking-Challenge"><a href="#Carvana-ImageMasking-Challenge" class="headerlink" title="Carvana ImageMasking Challenge"></a>Carvana ImageMasking Challenge</h1><h3 id="ä¸€ã€å®éªŒè¦æ±‚"><a href="#ä¸€ã€å®éªŒè¦æ±‚" class="headerlink" title="ä¸€ã€å®éªŒè¦æ±‚"></a>ä¸€ã€å®éªŒè¦æ±‚</h3><p>è‡ªåŠ¨è¯†åˆ«å›¾åƒä¸­æ±½è½¦çš„è¾¹ç•Œã€‚</p>
<p>è¦æ±‚ï¼šå¼€å‘ä¸€ç§è‡ªåŠ¨åˆ é™¤ç…§ç›¸é¦†èƒŒæ™¯çš„ç®—æ³•ã€‚</p>
<span id="more"></span>



<h3 id="äºŒã€å®éªŒæ€è·¯"><a href="#äºŒã€å®éªŒæ€è·¯" class="headerlink" title="äºŒã€å®éªŒæ€è·¯"></a>äºŒã€å®éªŒæ€è·¯</h3><h4 id="ä¸€ã€è§£æé—®é¢˜"><a href="#ä¸€ã€è§£æé—®é¢˜" class="headerlink" title="ä¸€ã€è§£æé—®é¢˜"></a>ä¸€ã€è§£æé—®é¢˜</h4><p>â€‹		ä»€ä¹ˆæ˜¯å›¾åƒåˆ†å‰²é—®é¢˜å‘¢ï¼Ÿ ç®€å•çš„æ¥è®²å°±æ˜¯ç»™ä¸€å¼ å›¾åƒï¼Œæ£€æµ‹æ˜¯ç”¨æ¡†å‡ºæ¡†å‡ºç‰©ä½“ï¼Œè€Œå›¾åƒåˆ†å‰²åˆ†å‡ºä¸€ä¸ªç‰©ä½“çš„å‡†ç¡®è½®å»“ã€‚ä¹Ÿè¿™æ ·è€ƒè™‘ï¼Œç»™å‡ºä¸€å¼ å›¾åƒ ï¼©ï¼Œè¿™ä¸ªé—®é¢˜å°±æ˜¯æ±‚ä¸€ä¸ªå‡½æ•°ï¼Œä»Iæ˜ å°„åˆ°Maskã€‚æ‰€ä»¥è¿™é‡Œkaggleçš„æ¯”èµ›åç§°ä¹Ÿå«åš ImageMasking Challenge ã€‚</p>
<h4 id="äºŒã€è§£å†³é—®é¢˜"><a href="#äºŒã€è§£å†³é—®é¢˜" class="headerlink" title="äºŒã€è§£å†³é—®é¢˜"></a>äºŒã€è§£å†³é—®é¢˜</h4><p>â€‹		çœ‹äº†ä¸€ä¸‹kaggleç½‘ç«™ä¸Šå¯¹è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹å¼ï¼Œå‘ç°å¤§éƒ¨åˆ†éƒ½æ˜¯ä½¿ç”¨unetè§£å†³ï¼Œä½¿ç”¨CNNçš„æ•ˆæœéƒ½å¾ˆå·®ï¼Œå…¶ä½™ç½‘ç»œçš„æåŠä¹Ÿå¾ˆå°‘ã€‚UNETç›¸æ¯”äºCNNæ›´é€‚ç”¨äºå›¾åƒåˆ†å‰²ï¼Œå› ä¸ºå®ƒçš„ç¼–ç -è§£ç ç»“æ„å’Œè·³è·ƒè¿æ¥æœºåˆ¶ä½¿å¾—ç½‘ç»œèƒ½å¤ŸåŒæ—¶å­¦ä¹ åˆ°å…¨å±€ä¿¡æ¯å’Œå±€éƒ¨ç»†èŠ‚ï¼Œå¹¶ä¸”èƒ½å¤Ÿåˆ©ç”¨ä¸åŒå±‚æ¬¡çš„ç‰¹å¾è¿›è¡Œè¯­ä¹‰ä¿¡æ¯ä¼ é€’ï¼Œæé«˜åˆ†å‰²å‡†ç¡®æ€§ã€‚</p>
<p>â€‹	   <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1505.04597v1">U-NETåŸè®ºæ–‡åœ°å€</a>U-netæ˜¯ä¸€ä¸ªç”¨äºåŒ»å­¦å›¾åƒåˆ†å‰²çš„å…¨å·ç§¯ç¥ç»ç½‘ç»œã€‚ç›®å‰å¾ˆå¤šç¥ç»ç½‘ç»œçš„è¾“å‡ºç»“æœéƒ½æ˜¯æœ€ç»ˆçš„åˆ†ç±»ç±»åˆ«æ ‡ç­¾ï¼Œä½†å¯¹åŒ»å­¦å½±åƒçš„å¤„ç†ï¼ŒåŒ»åŠ¡äººå‘˜é™¤äº†æƒ³è¦çŸ¥é“å›¾åƒçš„ç±»åˆ«ä»¥å¤–ï¼Œæ›´æƒ³çŸ¥é“çš„æ˜¯å›¾åƒä¸­å„ç§ç»„ç»‡çš„ä½ç½®åˆ†å¸ƒï¼Œè€ŒU-netå°±å¯ä»¥å®ç°å›¾ç‰‡åƒç´ çš„å®šä½ï¼Œè¯¥ç½‘ç»œå¯¹å›¾åƒä¸­çš„æ¯ä¸€ä¸ªåƒç´ ç‚¹è¿›è¡Œåˆ†ç±»ï¼Œæœ€åè¾“å‡ºçš„æ˜¯æ ¹æ®åƒç´ ç‚¹çš„ç±»åˆ«è€Œåˆ†å‰²å¥½çš„å›¾åƒã€‚</p>
<h4 id="ä¸‰ã€U-netç»“æ„"><a href="#ä¸‰ã€U-netç»“æ„" class="headerlink" title="ä¸‰ã€U-netç»“æ„"></a>ä¸‰ã€U-netç»“æ„</h4><p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/kaggle-masking-report/image-20240524162510686.png" alt="image-20240524162510686"></p>
<p>â€‹	<strong>ç¼–ç å™¨éƒ¨åˆ†è´Ÿè´£å¯¹è¾“å…¥å›¾åƒè¿›è¡Œå¤šæ¬¡ä¸‹é‡‡æ ·ï¼Œä»¥æå–å›¾åƒçš„æŠ½è±¡ç‰¹å¾ã€‚å¸¸ç”¨çš„ä¸‹é‡‡æ ·æ–¹æ³•æ˜¯ä½¿ç”¨å·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œé€æ¸å‡å°ç‰¹å¾å›¾çš„å°ºå¯¸åŒæ—¶å¢åŠ é€šé“æ•°ã€‚è¿™æ ·å¯ä»¥å¸®åŠ©ç½‘ç»œå­¦ä¹ åˆ°æ›´é«˜çº§åˆ«çš„è¯­ä¹‰ä¿¡æ¯ï¼Œå¹¶å‡å°ç‰¹å¾å›¾çš„ç©ºé—´ç»´åº¦ã€‚</strong> </p>
<ul>
<li>â€‹	è¯¥U-netç½‘ç»œä¸€å…±æœ‰å››å±‚ï¼Œåˆ†åˆ«å¯¹å›¾ç‰‡è¿›è¡Œäº†4æ¬¡ä¸‹é‡‡æ ·å’Œ4æ¬¡ä¸Šé‡‡æ ·ã€‚å·¦ä¾§ä¸ºç¼–ç å™¨è¿›è¡Œä¸‹é‡‡æ ·çš„è¿‡ç¨‹ï¼Œè¾“å…¥çš„æ˜¯ä¸€å¼ 572Ã—572Ã—1çš„å›¾ç‰‡ï¼Œç„¶åç»è¿‡<strong>64</strong>ä¸ª3Ã—3çš„å·ç§¯æ ¸è¿›è¡Œå·ç§¯ï¼Œå†é€šè¿‡ReLUå‡½æ•°åå¾—åˆ°<strong>64ä¸ª570Ã—570Ã—1çš„ç‰¹å¾é€šé“</strong>ã€‚ç„¶åæŠŠè¿™570Ã—570Ã—64çš„ç»“æœå†ç»è¿‡64ä¸ª3Ã—3çš„å·ç§¯æ ¸è¿›è¡Œå·ç§¯ï¼ŒåŒæ ·é€šè¿‡ReLUå‡½æ•°åå¾—åˆ°64ä¸ª568Ã—568Ã—1çš„ç‰¹å¾æå–ç»“æœï¼Œè¿™å°±æ˜¯ç¬¬ä¸€å±‚çš„å¤„ç†ç»“æœã€‚</li>
<li>â€‹	ä¹‹åé‡å¤å››æ¬¡è¿›è¡Œä¸‹é‡‡æ ·ï¼Œæ¯ä¸‹é‡‡æ ·ä¸€æ¬¡å°±ä¼šæŠŠå›¾ç‰‡çš„å¤§å°å‡å°ä¸€èˆ¬ï¼Œå·ç§¯æ ¸å±‚æ•°å¢åŠ ä¸€å€ï¼Œè¿™æ ·å¤„ç†çš„å›¾ç‰‡å¤§å°è¶Šæ¥è¶Šå°ï¼Œè€Œç‰¹å¾ä¹Ÿä¼šæå–åˆ°ä¸åŒçš„ç‰¹å¾é€šé“ä¸­ã€‚</li>
</ul>
<p>â€‹	<strong>è§£ç å™¨éƒ¨åˆ†æ˜¯ç¼–ç å™¨çš„é•œåƒï¼Œè´Ÿè´£å°†ç¼–ç å™¨æå–çš„ç‰¹å¾è¿˜åŸåˆ°åŸå§‹å°ºå¯¸ï¼Œå¹¶ä»ä¸åŒå±‚æ¬¡èåˆç‰¹å¾ï¼Œç”Ÿæˆæœ€ç»ˆçš„åˆ†å‰²ç»“æœã€‚è¿™é‡Œé‡‡ç”¨äº†ä¸Šé‡‡æ ·å’Œå·ç§¯æ“ä½œï¼Œé€æ¸æ¢å¤ç‰¹å¾å›¾çš„å°ºå¯¸ï¼ŒåŒæ—¶è¿›è¡Œç‰¹å¾èåˆå’Œä¿¡æ¯ä¼ é€’ã€‚</strong> </p>
<ul>
<li>â€‹	å³è¾¹éƒ¨åˆ†ä»ä¸‹å¾€ä¸Šåˆ™æ˜¯4æ¬¡ä¸Šé‡‡æ ·è¿‡ç¨‹ã€‚ä»æœ€å³ä¸‹è§’å¼€å§‹ï¼ŒæŠŠ28Ã—28Ã—1024çš„ç‰¹å¾çŸ©é˜µç»è¿‡<strong>512ä¸ª</strong>2Ã—2çš„å·ç§¯æ ¸è¿›è¡Œåå·ç§¯ï¼ŒæŠŠçŸ©é˜µæ‰©å¤§ä¸º56Ã—56Ã—512ï¼Œ<strong>ç”±äºåå·ç§¯åªèƒ½æ‰©å¤§å›¾ç‰‡è€Œä¸èƒ½è¿˜åŸå›¾ç‰‡</strong>ï¼Œä¸ºäº†å‡å°‘æ•°æ®ä¸¢å¤±ï¼Œé‡‡å–æŠŠå·¦è¾¹é™é‡‡æ ·æ—¶çš„å›¾ç‰‡è£å‰ªæˆç›¸åŒå¤§å°åç›´æ¥æ‹¼è¿‡æ¥çš„æ–¹æ³•å¢åŠ ç‰¹å¾å±‚ï¼Œå†è¿›è¡Œå·ç§¯æ¥æå–ç‰¹å¾ã€‚</li>
<li>â€‹	æœ€ç»ˆä¸æ–­é‡å¤ï¼Œæ¯æ¬¡ä¸Šé‡‡æ ·éƒ½ä¼šè®©å›¾åƒå¤§å°æ‰©å¤§ä¸€å€è€Œå·ç§¯æ ¸å±‚æ•°å‡å°‘ï¼Œæœ€ç»ˆè·å¾—ä¸¤å±‚ç‰¹å¾è¾“å‡ºï¼Œå…¶å®ç›¸å½“äºåšäº†äºŒåˆ†ç±»çš„è¿‡ç¨‹ï¼Œè¾“å‡ºçš„åˆ†åˆ«æ˜¯ä¸€å±‚èƒŒæ™¯å’Œä¸€å±‚è½®å»“ç›®æ ‡ã€‚</li>
</ul>
<p>â€‹	UNETä½¿ç”¨è·³è·ƒè¿æ¥æ¥è¿æ¥ç¼–ç å™¨å’Œè§£ç å™¨çš„å¯¹åº”å±‚ã€‚è·³è·ƒè¿æ¥å¯ä»¥å¸®åŠ©ç½‘ç»œè¿›è¡Œå¤šå°ºåº¦ä¿¡æ¯çš„èåˆï¼Œæä¾›äº†æ›´ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¹¶é¿å…äº†ä¿¡æ¯ä¸¢å¤±ã€‚é€šè¿‡è·³è·ƒè¿æ¥ï¼ŒUNETèƒ½å¤Ÿå°†ä½å±‚æ¬¡çš„ç»†èŠ‚ç‰¹å¾ä¸é«˜å±‚æ¬¡çš„è¯­ä¹‰ç‰¹å¾ç›¸ç»“åˆï¼Œæé«˜å›¾åƒåˆ†å‰²çš„å‡†ç¡®æ€§ã€‚ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒUNETé€šå¸¸é‡‡ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°æ¥åº¦é‡åˆ†å‰²ç»“æœä¸çœŸå®æ ‡ç­¾çš„å·®å¼‚ï¼Œå¹¶é€šè¿‡åå‘ä¼ æ’­ç®—æ³•æ›´æ–°ç½‘ç»œçš„æƒé‡ã€‚æ­¤å¤–ï¼ŒUNETè¿˜å¯é‡‡ç”¨æ•°æ®å¢å¼ºæŠ€æœ¯æ¥å¢åŠ è®­ç»ƒæ ·æœ¬çš„å¤šæ ·æ€§ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p>
<h3 id="ä¸‰ã€å®éªŒè¿‡ç¨‹"><a href="#ä¸‰ã€å®éªŒè¿‡ç¨‹" class="headerlink" title="ä¸‰ã€å®éªŒè¿‡ç¨‹"></a>ä¸‰ã€å®éªŒè¿‡ç¨‹</h3><h4 id="A-u-netå®ç°"><a href="#A-u-netå®ç°" class="headerlink" title="A.u-netå®ç°"></a>A.u-netå®ç°</h4><p>   Kerasæ˜¯ä¸€ä¸ªé«˜çº§ç¥ç»ç½‘ç»œAPIï¼Œå®ƒå¯ä»¥ç”¨äºæ„å»ºã€è®­ç»ƒå’Œéƒ¨ç½²æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚Kerasæ˜¯å»ºç«‹åœ¨åº•å±‚æ·±åº¦å­¦ä¹ åº“ï¼ˆå¦‚TensorFlowã€Theanoç­‰ï¼‰ä¹‹ä¸Šçš„ï¼Œå®ƒæä¾›äº†ç®€åŒ–å’Œé«˜çº§æŠ½è±¡çš„æ¥å£ï¼Œä½¿å¾—æ¨¡å‹çš„æ„å»ºå’Œè®­ç»ƒè¿‡ç¨‹æ›´åŠ æ–¹ä¾¿å’Œå¿«æ·ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_unet_128</span>(<span class="params">input_shape=(<span class="params"><span class="number">128</span>, <span class="number">128</span>, <span class="number">3</span></span>),    <span class="comment">#åˆ†æˆrgbä¸‰ä¸ªé€šé“</span></span></span><br><span class="line"><span class="params">                 num_classes=<span class="number">1</span></span>):</span><br><span class="line">    inputs = Input(shape=input_shape)</span><br><span class="line">    <span class="comment"># 128</span></span><br><span class="line">    down1 = Conv2D(<span class="number">64</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">&#x27;same&#x27;</span>)(inputs)   <span class="comment">#ä½¿ç”¨3x3çš„å·ç§¯æ ¸å¯¹è¾“å…¥å›¾åƒè¿›è¡Œå·ç§¯æ“ä½œï¼Œç”Ÿæˆ64ä¸ªé€šé“çš„ç‰¹å¾å›¾ã€‚</span></span><br><span class="line">    down1 = BatchNormalization()(down1)<span class="comment">#åº”ç”¨æ‰¹é‡å½’ä¸€åŒ–ï¼ŒåŠ é€Ÿæ¨¡å‹æ”¶æ•›å’Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</span></span><br><span class="line">    down1 = Activation(<span class="string">&#x27;relu&#x27;</span>)(down1)<span class="comment">#æ¿€æ´»å‡½æ•°ReLUï¼Œå¼•å…¥éçº¿æ€§ç‰¹å¾ã€‚</span></span><br><span class="line">    down1 = Conv2D(<span class="number">64</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">&#x27;same&#x27;</span>)(down1) <span class="comment">#å†æ¬¡ä½¿ç”¨3x3çš„å·ç§¯æ ¸å¯¹ç‰¹å¾å›¾è¿›è¡Œå·ç§¯æ“ä½œï¼Œä¿æŒé€šé“æ•°ä¸å˜ã€‚</span></span><br><span class="line">    down1 = BatchNormalization()(down1)</span><br><span class="line">    down1 = Activation(<span class="string">&#x27;relu&#x27;</span>)(down1)</span><br><span class="line">    down1_pool = MaxPooling2D((<span class="number">2</span>, <span class="number">2</span>), strides=(<span class="number">2</span>, <span class="number">2</span>))(down1)<span class="comment">#ä½¿ç”¨2x2çš„æ± åŒ–æ ¸è¿›è¡Œä¸‹é‡‡æ ·ï¼Œå°†å›¾åƒå°ºå¯¸ç¼©å°ä¸€åŠï¼Œå¹¶ä¿ç•™æ¯ä¸ªç½‘æ ¼ä¸­çš„æœ€å¤§å€¼ã€‚è¿™æ ·åšå¯ä»¥å‡å°‘ç‰¹å¾å›¾çš„ç©ºé—´ç»´åº¦ï¼ŒåŒæ—¶ä¿ç•™ä¸»è¦çš„ç‰¹å¾ã€‚</span></span><br><span class="line">    <span class="comment"># 64  32  16  8</span></span><br><span class="line">    <span class="comment">#å…¶ä½™ä¸‹é‡‡æ ·è¿‡ç¨‹çœç•¥</span></span><br><span class="line">    center = Conv2D(<span class="number">1024</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">&#x27;same&#x27;</span>)(down4_pool)</span><br><span class="line">    center = BatchNormalization()(center)</span><br><span class="line">    center = Activation(<span class="string">&#x27;relu&#x27;</span>)(center)</span><br><span class="line">    center = Conv2D(<span class="number">1024</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">&#x27;same&#x27;</span>)(center)</span><br><span class="line">    center = BatchNormalization()(center)</span><br><span class="line">    center = Activation(<span class="string">&#x27;relu&#x27;</span>)(center)</span><br><span class="line">    <span class="comment"># center</span></span><br><span class="line">    up4 = UpSampling2D((<span class="number">2</span>, <span class="number">2</span>))(center)  <span class="comment">#ä½¿ç”¨2x2çš„ä¸Šé‡‡æ ·æ ¸å°†ç‰¹å¾å›¾çš„å°ºå¯¸æ”¾å¤§ä¸€å€ã€‚</span></span><br><span class="line">    up4 = concatenate([down4, up4], axis=<span class="number">3</span>)  <span class="comment">#å°†ä¸Šé‡‡æ ·åçš„ç‰¹å¾å›¾ä¸ç›¸åº”çš„ä¸‹é‡‡æ ·ç»“æœè¿›è¡Œæ‹¼æ¥ï¼Œä»¥èåˆä½å±‚æ¬¡å’Œé«˜å±‚æ¬¡çš„ç‰¹å¾ä¿¡æ¯ã€‚</span></span><br><span class="line">    up4 = Conv2D(<span class="number">512</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">&#x27;same&#x27;</span>)(up4)  <span class="comment">#ä½¿ç”¨3x3çš„å·ç§¯æ ¸å¯¹ç‰¹å¾å›¾è¿›è¡Œå·ç§¯æ“ä½œï¼Œç”Ÿæˆ512ä¸ªé€šé“çš„ç‰¹å¾å›¾ã€‚</span></span><br><span class="line">    up4 = BatchNormalization()(up4)</span><br><span class="line">    up4 = Activation(<span class="string">&#x27;relu&#x27;</span>)(up4)</span><br><span class="line">    up4 = Conv2D(<span class="number">512</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">&#x27;same&#x27;</span>)(up4)</span><br><span class="line">    up4 = BatchNormalization()(up4)</span><br><span class="line">    up4 = Activation(<span class="string">&#x27;relu&#x27;</span>)(up4)</span><br><span class="line">    up4 = Conv2D(<span class="number">512</span>, (<span class="number">3</span>, <span class="number">3</span>), padding=<span class="string">&#x27;same&#x27;</span>)(up4)</span><br><span class="line">    up4 = BatchNormalization()(up4)</span><br><span class="line">    up4 = Activation(<span class="string">&#x27;relu&#x27;</span>)(up4)</span><br><span class="line">    <span class="comment"># 16  32 64 128</span></span><br><span class="line">    <span class="comment"># å…¶ä½™ä¸Šé‡‡æ ·è¿‡ç¨‹çœç•¥</span></span><br><span class="line">    classify = Conv2D(num_classes, (<span class="number">1</span>, <span class="number">1</span>), activation=<span class="string">&#x27;sigmoid&#x27;</span>)(up1)  <span class="comment">#ä½¿ç”¨1x1çš„å·ç§¯æ ¸å¯¹ç‰¹å¾å›¾è¿›è¡Œå·ç§¯æ“ä½œï¼Œå°†é€šé“æ•°è°ƒæ•´ä¸ºç±»åˆ«æ•°ï¼ˆè¿™é‡Œæ˜¯1ï¼‰ï¼Œå¹¶é€šè¿‡Sigmoidæ¿€æ´»å‡½æ•°è¾“å‡ºæ¯ä¸ªåƒç´ å±äºç›®æ ‡ç±»åˆ«çš„æ¦‚ç‡ã€‚</span></span><br><span class="line">    model = Model(inputs=inputs, outputs=classify)</span><br><span class="line">    model.<span class="built_in">compile</span>(optimizer=RMSprop(lr=<span class="number">0.0001</span>), loss=bce_dice_loss, metrics=[dice_coeff])</span><br><span class="line">    <span class="keyword">return</span> model</span><br></pre></td></tr></table></figure>

<p>â€‹	è¿™é‡Œçš„ä»£ç åŒ…æ‹¬äº†ä¸‹é‡‡æ ·è·¯å¾„å’Œä¸Šé‡‡æ ·è·¯å¾„ï¼Œé€šè¿‡è·³è·ƒè¿æ¥æ¥ä¿ç•™ä¸‹é‡‡æ ·è¿‡ç¨‹ä¸­çš„ç»†èŠ‚ä¿¡æ¯ï¼Œå¹¶æœ€ç»ˆè¾“å‡ºåˆ†å‰²ç»“æœã€‚ç½‘ç»œçš„è¾“å…¥æ˜¯ä¸€ä¸ªå¤§å°ä¸º128x128x3çš„å›¾åƒï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªå¤§å°ä¸º128x128x1çš„äºŒå€¼åˆ†å‰²å›¾ã€‚</p>
<h4 id="B-loss"><a href="#B-loss" class="headerlink" title="B.loss"></a>B.loss</h4><p>â€‹	åœ¨Unetçš„å®ç°ä¸­å°†æŸå¤±å‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œè¿™é‡Œä»‹ç»æŸå¤±å‡½æ•°çš„å…·ä½“å®ç°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.<span class="built_in">compile</span>(optimizer=RMSprop(lr=<span class="number">0.0001</span>), loss=bce_dice_loss, metrics=[dice_coeff])</span><br></pre></td></tr></table></figure>

<p>Diceç³»æ•°æ˜¯ä¸€ç§å¸¸ç”¨çš„åˆ†å‰²ä»»åŠ¡è¯„ä¼°æŒ‡æ ‡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæŸå¤±å‡½æ•°ä½¿ç”¨ã€‚å®ƒè¡¡é‡äº†é¢„æµ‹ç»“æœä¸çœŸå€¼ä¹‹é—´çš„é‡å ç¨‹åº¦ã€‚å‡½æ•°ä¸­ï¼Œy_trueè¡¨ç¤ºçœŸå®æ ‡ç­¾ï¼Œy_predè¡¨ç¤ºé¢„æµ‹æ ‡ç­¾ã€‚å¹³æ»‘å› å­smoothç”¨äºé¿å…åˆ†æ¯ä¸º0ï¼Œå°†çœŸå®æ ‡ç­¾å’Œé¢„æµ‹æ ‡ç­¾å±•å¹³åè®¡ç®—å®ƒä»¬çš„äº¤é›†ï¼ˆç›¸ä¹˜ï¼‰ï¼Œç„¶åè®¡ç®—Diceç³»æ•°.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dice_coeff</span>(<span class="params">y_true, y_pred</span>):</span><br><span class="line">    smooth = <span class="number">1.</span></span><br><span class="line">    y_true_f = K.flatten(y_true)</span><br><span class="line">    y_pred_f = K.flatten(y_pred)</span><br><span class="line">    intersection = K.<span class="built_in">sum</span>(y_true_f * y_pred_f)</span><br><span class="line">    score = (<span class="number">2.</span> * intersection + smooth) / (K.<span class="built_in">sum</span>(y_true_f) + K.<span class="built_in">sum</span>(y_pred_f) + smooth)</span><br><span class="line">    <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure>

<p>dice_losså‡½æ•°:   <strong>1 - dice_coeff</strong>  ï¼Œå³çœŸå€¼å’Œé¢„æµ‹ä¹‹é—´çš„å·®å¼‚è¶Šå°ï¼Œlossè¶Šå°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dice_loss</span>(<span class="params">y_true, y_pred</span>):</span><br><span class="line">    loss = <span class="number">1</span> - dice_coeff(y_true, y_pred)</span><br><span class="line">    <span class="keyword">return</span> loss</span><br></pre></td></tr></table></figure>

<p>bce_dice_losså‡½æ•°ï¼šå°†äºŒå…ƒäº¤å‰ç†µæŸå¤±å’ŒDice Lossç»“åˆçš„ä¸€ç§æŸå¤±å‡½æ•°ã€‚å®ƒè€ƒè™‘äº†ä¸¤ä¸ªæ–¹é¢ï¼Œå³åƒç´ çº§åˆ«çš„åˆ†ç±»è¯¯å·®å’Œåˆ†å‰²ç»“æœçš„ç›¸ä¼¼æ€§ã€‚æŸå¤±å‡½æ•°æ˜¯äºŒå…ƒäº¤å‰ç†µæŸå¤±ä¸Dice Lossä¹‹å’Œã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">bce_dice_loss</span>(<span class="params">y_true, y_pred</span>):</span><br><span class="line">    loss = binary_crossentropy(y_true, y_pred) + dice_loss(y_true, y_pred)</span><br><span class="line">    <span class="keyword">return</span> loss</span><br></pre></td></tr></table></figure>

<h4 id="c-å›¾åƒå¢å¼º"><a href="#c-å›¾åƒå¢å¼º" class="headerlink" title="c.å›¾åƒå¢å¼º"></a>c.å›¾åƒå¢å¼º</h4><p>è¿™ä¸€èŠ‚ä»‹ç»å¯¹æ•°æ®é›†çš„å›¾åƒå¢å¼ºå¤„ç†æ–¹æ³•ï¼Œå¢å¼ºæ¨¡å‹çš„æŠ—å¹²æ‰°æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚</p>
<h5 id="1-RGBâ€”-HSV"><a href="#1-RGBâ€”-HSV" class="headerlink" title="1. RGBâ€”-&gt;HSV"></a>1. RGBâ€”-&gt;HSV</h5><p>é¦–å…ˆï¼Œä»£ç é€šè¿‡cv2.cvtColorå°†RGBå›¾åƒè½¬æ¢ä¸ºHSVé¢œè‰²ç©ºé—´ï¼ŒHSVè¡¨ç¤ºè‰²è°ƒï¼ˆHueï¼‰ã€é¥±å’Œåº¦ï¼ˆSaturationï¼‰å’Œæ˜åº¦ï¼ˆValueï¼‰ã€‚ç„¶åï¼Œä»£ç æ ¹æ®è¾“å…¥çš„å‚æ•°hue_shift_limitã€sat_shift_limitå’Œval_shift_limitéšæœºç”Ÿæˆè‰²è°ƒã€é¥±å’Œåº¦å’Œæ˜åº¦çš„åç§»é‡ã€‚è¿™äº›å‚æ•°ç¡®å®šäº†è‰²è°ƒã€é¥±å’Œåº¦å’Œæ˜åº¦çš„å˜åŒ–èŒƒå›´ã€‚ æ¥ç€ï¼Œä»£ç åˆ†åˆ«å¯¹è‰²è°ƒã€é¥±å’Œåº¦å’Œæ˜åº¦è¿›è¡Œåç§»æ“ä½œï¼Œä½¿ç”¨cv2.addå‡½æ•°å°†ç”Ÿæˆçš„åç§»é‡åŠ åˆ°å¯¹åº”çš„é€šé“ä¸Šã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">image = cv2.cvtColor(image, cv2.COLOR_BGR2HSV)</span><br><span class="line">      h, s, v = cv2.split(image)</span><br><span class="line">      hue_shift = np.random.uniform(hue_shift_limit[<span class="number">0</span>], hue_shift_limit[<span class="number">1</span>])</span><br><span class="line">      h = cv2.add(h, hue_shift)</span><br><span class="line">      sat_shift = np.random.uniform(sat_shift_limit[<span class="number">0</span>], sat_shift_limit[<span class="number">1</span>])</span><br><span class="line">      s = cv2.add(s, sat_shift)</span><br><span class="line">      val_shift = np.random.uniform(val_shift_limit[<span class="number">0</span>], val_shift_limit[<span class="number">1</span>])</span><br><span class="line">      v = cv2.add(v, val_shift)</span><br><span class="line">      image = cv2.merge((h, s, v))</span><br><span class="line">      image = cv2.cvtColor(image, cv2.COLOR_HSV2BGR)</span><br></pre></td></tr></table></figure>

<h5 id="2-éšæœºå¹³ç§»ï¼Œç¼©æ”¾ï¼Œæ—‹è½¬"><a href="#2-éšæœºå¹³ç§»ï¼Œç¼©æ”¾ï¼Œæ—‹è½¬" class="headerlink" title="2. éšæœºå¹³ç§»ï¼Œç¼©æ”¾ï¼Œæ—‹è½¬"></a>2. éšæœºå¹³ç§»ï¼Œç¼©æ”¾ï¼Œæ—‹è½¬</h5><p>è¿™æ®µä»£ç é€šè¿‡éšæœºçš„å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬æ¥æ”¹å˜è¾“å…¥å›¾åƒçš„å¤–è§‚ï¼Œä»¥å¢å¼ºè®­ç»ƒæ•°æ®çš„å¤šæ ·æ€§ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">height, width, channel = image.shape</span><br><span class="line">        angle = np.random.uniform(rotate_limit[<span class="number">0</span>], rotate_limit[<span class="number">1</span>])  <span class="comment"># degree</span></span><br><span class="line">        scale = np.random.uniform(<span class="number">1</span> + scale_limit[<span class="number">0</span>], <span class="number">1</span> + scale_limit[<span class="number">1</span>])</span><br><span class="line">        aspect = np.random.uniform(<span class="number">1</span> + aspect_limit[<span class="number">0</span>], <span class="number">1</span> + aspect_limit[<span class="number">1</span>])</span><br><span class="line">        sx = scale * aspect / (aspect ** <span class="number">0.5</span>)</span><br><span class="line">        sy = scale / (aspect ** <span class="number">0.5</span>)</span><br><span class="line">        dx = <span class="built_in">round</span>(np.random.uniform(shift_limit[<span class="number">0</span>], shift_limit[<span class="number">1</span>]) * width)</span><br><span class="line">        dy = <span class="built_in">round</span>(np.random.uniform(shift_limit[<span class="number">0</span>], shift_limit[<span class="number">1</span>]) * height)</span><br><span class="line"></span><br><span class="line">        cc = np.math.cos(angle / <span class="number">180</span> * np.math.pi) * sx</span><br><span class="line">        ss = np.math.sin(angle / <span class="number">180</span> * np.math.pi) * sy</span><br><span class="line">        rotate_matrix = np.array([[cc, -ss], [ss, cc]])</span><br><span class="line"></span><br><span class="line">        box0 = np.array([[<span class="number">0</span>, <span class="number">0</span>], [width, <span class="number">0</span>], [width, height], [<span class="number">0</span>, height], ])</span><br><span class="line">        box1 = box0 - np.array([width / <span class="number">2</span>, height / <span class="number">2</span>])</span><br><span class="line">        box1 = np.dot(box1, rotate_matrix.T) + np.array([width / <span class="number">2</span> + dx, height / <span class="number">2</span> + dy])</span><br><span class="line"></span><br><span class="line">        box0 = box0.astype(np.float32)</span><br><span class="line">        box1 = box1.astype(np.float32)</span><br><span class="line">        mat = cv2.getPerspectiveTransform(box0, box1)</span><br></pre></td></tr></table></figure>

<h5 id="3-éšæœºæ°´å¹³ç¿»è½¬"><a href="#3-éšæœºæ°´å¹³ç¿»è½¬" class="headerlink" title="3. éšæœºæ°´å¹³ç¿»è½¬"></a>3. éšæœºæ°´å¹³ç¿»è½¬</h5><p>è¿™æ®µä»£ç å®ç°äº†éšæœºæ°´å¹³ç¿»è½¬å›¾åƒçš„æ“ä½œã€‚å®ƒæ¥å—è¾“å…¥å›¾åƒå’Œå¯¹åº”çš„æ©è†œï¼ˆmaskï¼‰ï¼Œç„¶åæ ¹æ®ç»™å®šçš„æ¦‚ç‡<code>u</code>å†³å®šæ˜¯å¦è¿›è¡Œæ°´å¹³ç¿»è½¬æ“ä½œã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">randomHorizontalFlip</span>(<span class="params">image, mask, u=<span class="number">0.5</span></span>):</span><br><span class="line">    <span class="keyword">if</span> np.random.random() &lt; u:</span><br><span class="line">        image = cv2.flip(image, <span class="number">1</span>)</span><br><span class="line">        mask = cv2.flip(mask, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> image, mask</span><br></pre></td></tr></table></figure>

<h4 id="d-ç”Ÿæˆå™¨"><a href="#d-ç”Ÿæˆå™¨" class="headerlink" title="d.ç”Ÿæˆå™¨"></a>d.ç”Ÿæˆå™¨</h4><p>ä½¿ç”¨ä¸€ä¸ªæ— é™å¾ªç¯æ¥ç”Ÿæˆè®­ç»ƒæ•°æ®å’ŒéªŒè¯æ•°æ®çš„æ‰¹æ¬¡ã€‚å¯¹äºæ¯ä¸ªæ‰¹æ¬¡ï¼Œå®ƒä»<code>ids_train_split</code>åˆ—è¡¨ä¸­é€‰æ‹©ä¸€éƒ¨åˆ†è®­ç»ƒæ ·æœ¬çš„IDï¼Œå¹¶ä¾æ¬¡å¤„ç†æ¯ä¸ªIDã€‚å¯¹äºæ¯ä¸ªIDï¼Œå®ƒè¯»å–å¯¹åº”çš„å›¾åƒæ–‡ä»¶å’Œæ©ç æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œä¸€ç³»åˆ—çš„å›¾åƒå¢å¼ºæ“ä½œï¼ŒåŒ…æ‹¬é¢œè‰²å˜æ¢ã€å¹³ç§»ç¼©æ”¾æ—‹è½¬å’Œæ°´å¹³ç¿»è½¬ã€‚ç„¶åï¼Œå®ƒå°†å¢å¼ºåçš„å›¾åƒå’Œæ©ç æ·»åŠ åˆ°æ‰¹æ¬¡ä¸­ã€‚æœ€åï¼Œå®ƒå°†æ‰¹æ¬¡ä¸­çš„å›¾åƒå’Œæ©ç è½¬æ¢ä¸º<code>np.float32</code>æ•°æ®ç±»å‹ï¼Œå¹¶å¯¹å›¾åƒå’Œæ©ç è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå°†åƒç´ å€¼ç¼©æ”¾åˆ°[0, 1]çš„èŒƒå›´å†…ã€‚æœ€åï¼Œä½¿ç”¨<code>yield</code>è¯­å¥å°†æ‰¹æ¬¡è¿”å›ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train_generator</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> start <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ids_train_split), batch_size):</span><br><span class="line">            x_batch = []</span><br><span class="line">            y_batch = []</span><br><span class="line">            end = <span class="built_in">min</span>(start + batch_size, <span class="built_in">len</span>(ids_train_split))</span><br><span class="line">            ids_train_batch = ids_train_split[start:end]</span><br><span class="line">            <span class="keyword">for</span> <span class="built_in">id</span> <span class="keyword">in</span> ids_train_batch.values:</span><br><span class="line">                img = cv2.imread(<span class="string">&#x27;input/train/&#123;&#125;.jpg&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">id</span>)) <span class="comment">#è¯»å›¾ç‰‡</span></span><br><span class="line">                img = cv2.resize(img, (input_size, input_size))</span><br><span class="line">                mask = cv2.imread(<span class="string">&#x27;input/train_masks/&#123;&#125;_mask.png&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">id</span>), cv2.IMREAD_GRAYSCALE) <span class="comment">#è¯»æ©ç </span></span><br><span class="line">                mask = cv2.resize(mask, (input_size, input_size))</span><br><span class="line">                img = randomHueSaturationValue(img, <span class="comment">#HSVé¢œè‰²ç©ºé—´å˜åŒ–ä¸åŠ å¼º</span></span><br><span class="line">                                               hue_shift_limit=(-<span class="number">50</span>, <span class="number">50</span>),</span><br><span class="line">                                               sat_shift_limit=(-<span class="number">5</span>, <span class="number">5</span>),</span><br><span class="line">                                               val_shift_limit=(-<span class="number">15</span>, <span class="number">15</span>))</span><br><span class="line">                img, mask = randomShiftScaleRotate(img, mask,<span class="comment"># éšæœºå›¾åƒç¼©æ”¾å¹³ç§»æ—‹è½¬</span></span><br><span class="line">                                                   shift_limit=(-<span class="number">0.0625</span>, <span class="number">0.0625</span>),</span><br><span class="line">                                                   scale_limit=(-<span class="number">0.1</span>, <span class="number">0.1</span>),</span><br><span class="line">                                                   rotate_limit=(-<span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">                img, mask = randomHorizontalFlip(img, mask) <span class="comment">#éšæœºç¿»è½¬</span></span><br><span class="line">                mask = np.expand_dims(mask, axis=<span class="number">2</span>)</span><br><span class="line">                x_batch.append(img)</span><br><span class="line">                y_batch.append(mask)</span><br><span class="line">            x_batch = np.array(x_batch, np.float32) / <span class="number">255</span></span><br><span class="line">            y_batch = np.array(y_batch, np.float32) / <span class="number">255</span></span><br><span class="line">            <span class="keyword">yield</span> x_batch, y_batch</span><br></pre></td></tr></table></figure>

<h4 id="e-è®­ç»ƒ"><a href="#e-è®­ç»ƒ" class="headerlink" title="e.è®­ç»ƒ"></a>e.è®­ç»ƒ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model.fit_generator(generator=train_generator(),</span><br><span class="line">                    steps_per_epoch=np.ceil(<span class="built_in">float</span>(<span class="built_in">len</span>(ids_train_split)) / <span class="built_in">float</span>(batch_size)),</span><br><span class="line">                    epochs=epochs,</span><br><span class="line">                    verbose=<span class="number">2</span>,</span><br><span class="line">                    callbacks=callbacks,</span><br><span class="line">                    validation_data=valid_generator(),</span><br><span class="line">                    validation_steps=np.ceil(<span class="built_in">float</span>(<span class="built_in">len</span>(ids_valid_split)) / <span class="built_in">float</span>(batch_size)))</span><br></pre></td></tr></table></figure>

<p>å°†è¿™äº›ä½œä¸ºå‚æ•°ä¼ å…¥è®­ç»ƒå™¨ä¸­ï¼Œå¼€å§‹è®­ç»ƒå‡½æ•°ï¼Œè®­ç»ƒå‡ºçš„æ¨¡å‹ä¿å­˜åœ¨modelsæ–‡ä»¶åŠä¸­ã€‚</p>
<h4 id="f-é¢„æµ‹"><a href="#f-é¢„æµ‹" class="headerlink" title="f. é¢„æµ‹"></a>f. é¢„æµ‹</h4><p>ä¹‹ååŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡ï¼ŒæŠŠç»è¿‡è§„èŒƒåŒ–çš„å›¾ç‰‡ä¼ å…¥æ¨¡å‹åè·å¾—é¢„æµ‹ç»“æœï¼Œå†è°ƒæ•´é¢„æµ‹çš„æ©ç ï¼Œä½œç”¨äºåŸæœ¬çš„å›¾ç‰‡æœ€ç»ˆå¾—åˆ°åˆ é™¤èƒŒæ™¯çš„ç…§ç›¸é¦†æ±½è½¦å›¾ç‰‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">model.load_weights(filepath=<span class="string">&#x27;weights/best_weights.hdf5&#x27;</span>)  <span class="comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹æƒé‡</span></span><br><span class="line"><span class="keyword">for</span> start <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ids_test), batch_size)):</span><br><span class="line">    x_batch = []  <span class="comment"># åˆå§‹åŒ–ç©ºåˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨æ‰¹é‡è¾“å…¥å›¾åƒ</span></span><br><span class="line">    end = <span class="built_in">min</span>(start + batch_size, <span class="built_in">len</span>(ids_test))  <span class="comment"># ç¡®å®šå½“å‰æ‰¹æ¬¡çš„ç»“æŸç´¢å¼•</span></span><br><span class="line">    ids_test_batch = ids_test[start:end]  <span class="comment"># è·å–æµ‹è¯•IDçš„æ‰¹æ¬¡</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">id</span> <span class="keyword">in</span> ids_test_batch.values:</span><br><span class="line">        img = cv2.imread(<span class="string">&#x27;input/test/&#123;&#125;.jpg&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">id</span>))  <span class="comment"># è¯»å–è¾“å…¥çš„æµ‹è¯•å›¾åƒ</span></span><br><span class="line">        img = cv2.resize(img, (input_size, input_size))  <span class="comment"># è°ƒæ•´å›¾åƒå¤§å°ä»¥åŒ¹é…æ¨¡å‹çš„è¾“å…¥å°ºå¯¸</span></span><br><span class="line">        x_batch.append(img)  <span class="comment"># å°†é¢„å¤„ç†åçš„å›¾åƒæ·»åŠ åˆ°æ‰¹æ¬¡åˆ—è¡¨ä¸­</span></span><br><span class="line">    x_batch = np.array(x_batch, np.float32) / <span class="number">255</span>  <span class="comment"># å°†å›¾åƒæ‰¹æ¬¡è§„èŒƒåŒ–</span></span><br><span class="line">    preds = model.predict_on_batch(x_batch)  <span class="comment"># å¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„æµ‹</span></span><br><span class="line">    preds = np.squeeze(preds, axis=<span class="number">3</span>)  <span class="comment"># ä»é¢„æµ‹ç»“æœä¸­ç§»é™¤å†—ä½™çš„ç»´åº¦</span></span><br><span class="line">    <span class="keyword">for</span> i, pred <span class="keyword">in</span> <span class="built_in">enumerate</span>(preds):</span><br><span class="line">        prob = cv2.resize(pred, (orig_width, orig_height))  <span class="comment"># è°ƒæ•´é¢„æµ‹æ©è†œçš„å¤§å°ä»¥åŒ¹é…åŸå§‹å›¾åƒå°ºå¯¸</span></span><br><span class="line">        mask = prob &gt; threshold  <span class="comment"># åŸºäºæ¦‚ç‡é˜ˆå€¼åˆ›å»ºäºŒå€¼æ©è†œ</span></span><br><span class="line">        img = cv2.imread(<span class="string">&#x27;input/test/&#123;&#125;.jpg&#x27;</span>.<span class="built_in">format</span>(ids_test[start + i]))  <span class="comment"># è¯»å–åŸå§‹çš„æµ‹è¯•å›¾åƒ</span></span><br><span class="line">        img = cv2.resize(img, (orig_width, orig_height))  <span class="comment"># è°ƒæ•´åŸå§‹å›¾åƒçš„å¤§å°ä»¥åŒ¹é…æ©è†œå¤§å°</span></span><br><span class="line">        img[~mask] = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]  <span class="comment"># å°†æ©è†œåº”ç”¨åˆ°åŸå§‹å›¾åƒä¸Š</span></span><br><span class="line">        cv2.imwrite(<span class="string">&#x27;output/&#123;&#125;.jpg&#x27;</span>.<span class="built_in">format</span>(ids_test[start + i]), img)  <span class="comment"># å°†æ©è†œå›¾åƒä¿å­˜åˆ°è¾“å‡ºæ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">        rle = run_length_encode(mask)  <span class="comment"># å°†æ©è†œç¼–ç ä¸ºRun-Lengthæ ¼å¼</span></span><br><span class="line">        rles.append(rle)  <span class="comment"># å°†ç¼–ç åçš„æ©è†œæ·»åŠ åˆ°RLEåˆ—è¡¨ä¸­</span></span><br></pre></td></tr></table></figure>

<h3 id="å››ã€è®­ç»ƒè¿‡ç¨‹"><a href="#å››ã€è®­ç»ƒè¿‡ç¨‹" class="headerlink" title="å››ã€è®­ç»ƒè¿‡ç¨‹"></a>å››ã€è®­ç»ƒè¿‡ç¨‹</h3><p>â€‹	ç›´æ¥åœ¨æœ¬åœ°è¿è¡Œä»£ç ï¼Œæ²¡æœ‰ä½¿ç”¨kaggleçš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥æ¡ä»¶é™åˆ¶å°±åªè®­ç»ƒäº†äº”è½®ã€‚åŠ è½½æ¨¡å‹ä¹‹åï¼Œå¼€å§‹æ¯ä¸€è½®çš„è®­ç»ƒï¼Œç”±äºkaggleçš„è®­ç»ƒé›†è¿‡äºå¤§ï¼Œæ‰€ä»¥æ¯ä¸€è½®éƒ½è¦èŠ±è´¹è¾ƒå¤šæ—¶é—´å’Œèµ„æºã€‚</p>
<p><img src= "/gina511.github.io/img/loading.gif" data-src="/gina511.github.io/images/post-image/kaggle-masking-report/image-20240516200309746.png" alt="image-20240516200309746"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Epoch 1/5</span><br><span class="line">255/255 - 2536s - loss: 0.1780 - dice_coeff: 0.8944 - val_loss: 1.7487 - val_dice_coeff: 0.0485 - lr: 1.0000e-04 - 2536s/epoch - 10s/step</span><br><span class="line">Epoch 2/5</span><br><span class="line">255/255 - 2478s - loss: 0.0763 - dice_coeff: 0.9548 - val_loss: 0.0859 - val_dice_coeff: 0.9512 - lr: 1.0000e-04 - 2478s/epoch - 10s/step</span><br><span class="line">Epoch 3/5</span><br><span class="line">255/255 - 2485s - loss: 0.0517 - dice_coeff: 0.9707 - val_loss: 0.0404 - val_dice_coeff: 0.9770 - lr: 1.0000e-04 - 2485s/epoch - 10s/step</span><br><span class="line">Epoch 4/5</span><br><span class="line">255/255 - 2497s - loss: 0.0409 - dice_coeff: 0.9778 - val_loss: 0.0815 - val_dice_coeff: 0.9556 - lr: 1.0000e-04 - 2497s/epoch - 10s/step</span><br><span class="line">Epoch 5/5</span><br><span class="line">255/255 - 2479s - loss: 0.0353 - dice_coeff: 0.9813 - val_loss: 0.0298 - val_dice_coeff: 0.9844 - lr: 1.0000e-04 - 2479s/epoch - 10s/step</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è®­ç»ƒè¿‡ç¨‹è¾“å‡ºæŸå¤±å€¼å˜åŒ–å’Œé¢„æµ‹å‡†ç¡®åº¦</p>
<img src= "/gina511.github.io/img/loading.gif" data-src="/images/post-image/kaggle-masking-report/image-20240525134433622.png" alt="image-20240525134433622" style="zoom:67%;" />

<p>å¯ä»¥çœ‹åˆ°éšç€è®­ç»ƒä¼¦æ¬¡çš„ä¸æ–­å¢å¤šï¼Œè®­ç»ƒé›†åˆå’ŒéªŒè¯é›†çš„æŸå¤±å€¼éƒ½åœ¨é™ä½ï¼Œè€Œç”±äºè®­ç»ƒä¸€è½®ä¹‹åå†æ ¹æ®éªŒè¯é›†æŸå¤±å€¼è°ƒæ•´å‚æ•°ï¼Œæ‰€ä»¥éªŒè¯é›†åˆå§‹åŒ–çš„æŸå¤±å€¼ä¼šæ¯”è®­ç»ƒé›†ä½å¾ˆå¤šã€‚</p>
<img src= "/gina511.github.io/img/loading.gif" data-src="/images/post-image/kaggle-masking-report/image-20240525134453902.png" alt="image-20240525134453902" style="zoom:67%;" />

<p>è€Œéšç€è®­ç»ƒä¼¦æ¬¡ä¸æ–­å¢å¤šï¼Œæ¨¡å‹é¢„æµ‹çš„å‡†ç¡®åº¦ä¹Ÿåœ¨ä¸Šå‡ï¼ŒDICE coefficientæ˜¯æ¨¡å‹å‡†ç¡®åº¦çš„å«ä¹‰ï¼Œè¶Šæ¥è¿‘1è¯´æ˜é¢„æµ‹çš„å‡†ç¡®åº¦ä¹Ÿè¶Šé«˜ã€‚ä¹Ÿå¯ä»¥çœ‹åˆ°è®­ç»ƒå‰æœŸæ¨¡å‹å¿«é€Ÿæ”¶æ•›ï¼ŒåæœŸæ¨¡å‹å‚æ•°å˜åŒ–ï¼ŒæŸå¤±å€¼ä¸‹é™æ¢¯åº¦éƒ½æœ‰å‡ç¼“ã€‚</p>
<h3 id="äº”ã€è¾“å‡ºå›¾ç‰‡"><a href="#äº”ã€è¾“å‡ºå›¾ç‰‡" class="headerlink" title="äº”ã€è¾“å‡ºå›¾ç‰‡"></a>äº”ã€è¾“å‡ºå›¾ç‰‡</h3><p>åŸæœ¬kaggleç»™çš„é¢„æµ‹å›¾ç‰‡å¾ˆå¤šï¼Œè€Œè¯¾ç¨‹å®éªŒä¸­è€å¸ˆåšäº†åˆ å‡ï¼Œåªä¿ç•™äº†40å¼ éœ€è¦åˆ é™¤èƒŒæ™¯çš„å›¾ç‰‡ï¼Œäºæ˜¯åœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼ŒçœŸæ­£æ¨¡å‹é¢„æµ‹çš„æ—¶å€™ä»£ç è¿è¡Œå¾ˆå¿«ã€‚</p>
<p>å¹¶ä¸”kaggleæäº¤çš„æ˜¯æ©ç çš„csvæ–‡ä»¶ï¼Œcsvæ–‡ä»¶ä¸­æ˜¯æ©ç ç»è¿‡æµ®ç‚¹ç¼–ç ä¹‹åä¿å­˜çš„æ•°å€¼ï¼Œä¸å…·æœ‰å¯è¯»æ€§ï¼Œè™½ç„¶æœ€ç»ˆçš„è¯„ä»·æŒ‡æ ‡è¿˜æ˜¯å‚è€ƒæŸå¤±å€¼ï¼Œå‡†ç¡®åº¦ç­‰ç­‰ï¼Œä½†æ˜¯ä¸ºäº†è®©ç®—æ³•å®ç°å¯ç”¨æ€§ï¼Œå°±ä¿®æ”¹äº†ä»£ç ï¼Œå°†ç”Ÿæˆçš„csvä¸­çš„æ¨¡å‹é¢„æµ‹æ©ç ä½œç”¨äºåŸæœ¬çš„è¾“å…¥å›¾åƒä¸­ã€‚</p>
<img src= "/gina511.github.io/img/loading.gif" data-src="/images/post-image/kaggle-masking-report/image-20240525135327471.png" alt="image-20240525135327471" style="zoom:67%;" />

<p>åŸå§‹å›¾åƒ</p>
<img src= "/gina511.github.io/img/loading.gif" data-src="/images/post-image/kaggle-masking-report/image-20240525135350825.png" alt="image-20240525135350825" style="zoom:67%;" />

<p>æ©ç é®è”½å›¾åƒ</p>
<p>å¯ä»¥çœ‹åˆ°ä»…ä»…è®­ç»ƒ5è½®çš„Unetæ¨¡å‹ä¹Ÿèƒ½å¾ˆå¥½çš„å°†æ±½è½¦å›¾ç‰‡ä¸­çš„ç…§ç›¸é¦†èƒŒæ™¯åˆ é™¤ã€‚Unetæ¨¡å‹å¯¹äºèƒŒæ™¯å’Œç›®æ ‡ç‰©çš„ç‰¹å¾æå–èƒ½åŠ›çœŸçš„å¾ˆå¼ºã€‚</p>
<h3 id="å…­ã€å®éªŒæ”¶è·"><a href="#å…­ã€å®éªŒæ”¶è·" class="headerlink" title="å…­ã€å®éªŒæ”¶è·"></a>å…­ã€å®éªŒæ”¶è·</h3><p>ä¹‹å‰çš„è®¨è®ºè¯¾æ–‡çŒ®é˜…è¯»ä¸­ç»å¸¸æåˆ°Unetè¿™ä¸ªç½‘ç»œç»“æ„ï¼Œä½†æ˜¯ä¸€ç›´å¯¹è¿™ä¸ªçš„äº†è§£å¹¶ä¸æ·±å…¥ï¼Œå®Œæˆkaggleçš„å®éªŒä¹‹åå¯¹Unetçš„åŸç†å’Œå®ç°çš„è¿‡ç¨‹äº†è§£æ›´åŠ æ·±å…¥äº†ï¼Œå¹¶ä¸”å¯¹äºkerasè¿™ä¸ªæ·±åº¦å­¦ä¹ æ¡†æ¶çš„ä½¿ç”¨äº†è§£ä¹Ÿæ›´åŠ æ·±å…¥ã€‚å¹¶ä¸”ä¸Šè¯¾è€å¸ˆä¹Ÿä¸€ç›´æåˆ°å›¾åƒå¢å¼ºçš„æ–¹å¼ï¼Œå®Œæˆkaggleå®éªŒçš„æ—¶å€™å‚è€ƒäº†å¾ˆå¤šç½‘ä¸Šçš„ä»£ç ï¼Œå‘ç°äº†å¾ˆå¤šå›¾åƒå¢å¼ºçš„æ–¹æ³•ï¼ŒåŒ…æ‹¬å¹³ç§»ï¼Œæ—‹è½¬ï¼Œç¼©æ”¾ï¼Œç¿»è½¬ä»¥åŠå®ƒä»¬çš„å…·ä½“å®ç°ï¼Œå†™ä»£ç çš„èƒ½åŠ›ä¹Ÿupäº†ã€‚</p>
</div>
        
  </div>

  <div class="share-reward">
    <div class="share">
        
<div class="social-share" data-sites="facebook,twitter,wechat,weibo,qq"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css">
<script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script>


      </div>
        <div class="reward">
          
        </div>
    </div>
    
    <div class="post_tags">
      
        <i class="fas fa-tag"></i> <a href="/gina511.github.io/tags/UNET/" class="tag">UNET</a>
      
        <i class="fas fa-tag"></i> <a href="/gina511.github.io/tags/KAGGLE/" class="tag">KAGGLE</a>
      
        <i class="fas fa-tag"></i> <a href="/gina511.github.io/tags/%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2/" class="tag">å›¾åƒåˆ†å‰²</a>
      
        <i class="fas fa-tag"></i> <a href="/gina511.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/" class="tag">è®¡ç®—æœºè§†è§‰</a>
      
    </div>
    <div class="post-nav">
      
        <div class="post-nav-prev post-nav-item">
            <a href="/gina511.github.io/2024/04/23/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%86%B3%E7%AD%96%E6%A0%91/" >åŸºäºID3ç®—æ³•å’Œåå‰ªæçš„å†³ç­–æ ‘å®éªŒ<i class="fa fa-chevron-left"></i></a>
        </div>
      
      
        <div class="post-nav-next post-nav-item">
            <a href="/gina511.github.io/2024/04/12/gpt%E8%B0%83%E7%94%A8/" >NLPæ¥å£è°ƒç”¨è®°å½•<i class="fa fa-chevron-right"></i></a>
        </div>
      
    </div>
      



  <div id="valine"></div>
  <script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script>
  <script>
        new Valine({
          el: '#valine',
          appId: "",
          appKey: "",
          avatar: "mm",
          lang: "",
          meta: 'nick,mail,link'.split(','),
          requiredFields: 'nick,mail'.split(','),
          placeholder: "è¯„è®ºè®°å¾—å¸¦ä¸Šé‚®ç®±,ä½ çš„ç•™è¨€æˆ‘ä¼šé©¬ä¸Šæ”¶åˆ°é‚®ç®±æé†’å“’",
          pageSize:'10',
          recordIP: 'false',
          serverURLs: "",
          emojiCDN: "",
          enableQQ: "true",
        });
  </script>
  

</article>

    
<a id="gotop" href="javascript:" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
    






    
<div id="bottom-outer">
    <div id="bottom-inner">
        Â© 2020 <i class="fa fa-heart" id="heart"></i> Gina 
        <br>
        Powered by 
        <a target="_blank" rel="noopener" href="http://hexo.io">hexo</a> | Theme is <a target="_blank" rel="noopener" href="https://github.com/a2396837/hexo-theme-blank/">blank</a>
        
          <div class="icp-info">
            
          <a href="" target="_blank"> </a>
        </div>
        
    </div>  
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/layui-src@2.5.5/dist/layui.min.js"></script>



  
    <script src="/gina511.github.io/js/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
  

 



  <script>
    window.lazyLoadOptions = {
      elements_selector: 'img',
      threshold: 0
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script>   
  


  <script>
    var images = $('img').not('.nav-logo img').not('.card img').not($('a>img')).not('.reward-content img')
    images.each(function (i, o) {
      var lazyloadSrc = $(o).attr('data-src') ? $(o).attr('data-src') : $(o).attr('src')
      $(o).wrap(`<a href="${lazyloadSrc}" data-fancybox="group" data-caption="${$(o).attr('alt')}" class="fancybox"></a>`)
    })
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script>
  <script>
        $().fancybox({
      selector: '[data-fancybox]',
      loop: true,
      transitionEffect: 'slide',
      protect: true,
      buttons: ['slideShow', 'fullScreen', 'thumbs', 'close']
    })
  </script>   
  






  <script>
    jQuery(document).ready(function () {
      var QRBox = $('#QRBox');
      var MainBox = $('#MainBox');
      var AliPayQR = '';
      var WeChanQR = '';

      function showQR(QR) {
        if (QR) {
          MainBox.css('background-image', 'url(' + QR + ')');
        }
        $('#donateBox').addClass('blur');
        QRBox.fadeIn(300, function (argument) {
          MainBox.addClass('showQR');
        });
      }

      $('#donateBox>li').click(function (event) {
        var thisID = $(this).attr('id');
        if (thisID === 'AliPay') {
          showQR(AliPayQR);
        } else if (thisID === 'WeChat') {
          showQR(WeChanQR);
        }
      });

      MainBox.click(function (event) {
        MainBox.removeClass('showQR').addClass('hideQR');
        setTimeout(function (a) {
          QRBox.fadeOut(300, function (argument) {
            MainBox.removeClass('hideQR');
          });
          $('#DonateText,#donateBox,#github').removeClass('blur');
        }, 600);

      });
    });
  </script>
  




  <script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script>
  




  
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"></script>
<script>
!function (e, t, a) {
  var initCopyCode = function(){
    var copyHtml = '';
    copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
    copyHtml += '  <i class="fa fa-clipboard"></i><span>å¤åˆ¶</span>';
    copyHtml += '</button>';
    $(".highlight .code pre").before(copyHtml);
    new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
  }
  initCopyCode();
}(window, document);
</script>  
  

<script>
  var btntop = $('#gotop');
  btntop.on('click', function (e) {
    e.preventDefault();
    $('html, body').animate({ scrollTop: 0 }, '300');
  });

  var $table = $('.content table').not($('figure.highlight > table'))
$table.each(function () {
  $(this).wrap('<div class="table-wrap"></div>')
})
</script>



</html>